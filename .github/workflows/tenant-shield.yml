name: TENANT SHIELD                                                                                      
                                                                                                           
  on:                                                                                                      
    push:                                                                                                  
      branches: [main, develop]                                                                            
      paths: ['backend/**']                                                                                
    pull_request:                                                                                          
      branches: [main, develop]                                                                            
      paths: ['backend/**']                                                                                
                                                                                                           
  jobs:                                                                                                    
    tenant-lint:                                                                                           
      name: Tenant Isolation Lint                                                                          
      runs-on: ubuntu-latest                                                                               
      steps:                                                                                               
        - uses: actions/checkout@v4                                                                        
        - uses: actions/setup-node@v4                                                                      
          with:                                                                                            
            node-version: '20'                                                                             
            cache: 'npm'                                                                                   
            cache-dependency-path: backend/package-lock.json                                               
        - run: cd backend && npm ci                                                                        
        - run: cd backend && npm run lint:tenant                                                                         
            cache-dependency-path: backend/package-lock.json                                               
        - run: cd backend && npm ci                                                                        
        - run: cd backend && npm run test:tenant || true
