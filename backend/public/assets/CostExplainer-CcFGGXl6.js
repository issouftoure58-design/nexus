import{r as i,j as e}from"./index-_yXYEqcL.js";const j=()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")}`});function N(){const[n,o]=i.useState(null),[m,h]=i.useState(!0),[c,x]=i.useState(null);i.useEffect(()=>{d();const s=setInterval(d,3e4);return()=>clearInterval(s)},[]);const d=async()=>{try{const s=await fetch("/api/sentinel/explainer/analyze",{headers:j()});if(!s.ok)throw new Error("Failed to fetch analysis");const r=await s.json();o(r),x(null)}catch(s){console.error("Failed to fetch analysis:",s),x("Impossible de charger l'analyse")}finally{h(!1)}};if(m)return e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]},s))});if(c||!n)return e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"âš ï¸"}),e.jsx("div",{className:"text-red-800 font-medium",children:c||"DonnÃ©es non disponibles"}),e.jsx("button",{onClick:d,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"RÃ©essayer"})]});const{metrics:t,trends:l,insights:b,opportunities:a}=n,p={green:"bg-green-50 border-green-200 text-green-900",yellow:"bg-yellow-50 border-yellow-200 text-yellow-900",red:"bg-red-50 border-red-200 text-red-900",blue:"bg-blue-50 border-blue-200 text-blue-900",gray:"bg-gray-50 border-gray-200 text-gray-900"},g={HIGH:"bg-red-50 border-red-300 text-red-900",MEDIUM:"bg-yellow-50 border-yellow-300 text-yellow-900",LOW:"bg-blue-50 border-blue-300 text-blue-900",INFO:"bg-gray-50 border-gray-300 text-gray-900"},u={HIGH:"bg-red-600 text-white",MEDIUM:"bg-yellow-500 text-white",LOW:"bg-blue-500 text-white",INFO:"bg-gray-500 text-white"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:b.map((s,r)=>e.jsxs("div",{className:`border-2 rounded-xl p-4 transition-all hover:shadow-md ${p[s.color]}`,children:[e.jsx("div",{className:"text-xs font-medium opacity-70 mb-1",children:s.title}),e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[(typeof s.value=="number",s.value),(s.type==="performance"||s.type==="efficiency")&&"%",s.type==="opportunity"&&"â‚¬"]}),e.jsx("div",{className:"text-xs opacity-75 leading-tight",children:s.interpretation})]},r))}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-white",children:[e.jsx("h3",{className:"text-xl font-bold flex items-center gap-2",children:"ðŸ’° D'oÃ¹ viennent les coÃ»ts ?"}),e.jsx("p",{className:"text-purple-100 text-sm mt-1",children:"Analyse dÃ©taillÃ©e avec benchmarks industrie"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"COÃ›T TOTAL DU MOIS"}),e.jsxs("div",{className:"text-4xl font-bold text-purple-900 mt-1",children:[t.costs.total.toFixed(2),"â‚¬"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Aujourd'hui"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[t.costs.today.toFixed(4),"â‚¬"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 pt-4 border-t border-purple-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-600",children:"Appels total"}),e.jsx("div",{className:"text-lg font-semibold text-purple-900",children:t.calls.total.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-600",children:"Aujourd'hui"}),e.jsx("div",{className:"text-lg font-semibold text-purple-900",children:t.calls.today})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-purple-600",children:"CoÃ»t/appel"}),e.jsxs("div",{className:"text-lg font-semibold text-purple-900",children:[t.costs.avgPerCall,"â‚¬"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-green-600",children:"Ã‰conomisÃ©"}),e.jsxs("div",{className:"text-lg font-semibold text-green-700",children:[t.costs.saved,"â‚¬"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:"ðŸ“Š RÃ©partition par modÃ¨le IA"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"âš¡"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-green-800",children:"Claude Haiku"}),e.jsxs("span",{className:"text-sm text-green-600 ml-2",children:["(",t.calls.haiku," appels)"]})]})]}),e.jsxs("span",{className:"text-2xl font-bold text-green-700",children:[t.calls.distribution.haiku,"%"]})]}),e.jsx("div",{className:"w-full bg-green-200 rounded-full h-3 mb-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-3 rounded-full transition-all duration-700",style:{width:`${t.calls.distribution.haiku}%`}})}),e.jsxs("div",{className:"text-xs text-green-700",children:["Questions simples, FAQ, recherche â€¢ ",e.jsx("strong",{children:"0.25â‚¬/1M tokens"})," (88% moins cher)"]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ§ "}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-purple-800",children:"Claude Sonnet"}),e.jsxs("span",{className:"text-sm text-purple-600 ml-2",children:["(",t.calls.sonnet," appels)"]})]})]}),e.jsxs("span",{className:"text-2xl font-bold text-purple-700",children:[t.calls.distribution.sonnet,"%"]})]}),e.jsx("div",{className:"w-full bg-purple-200 rounded-full h-3 mb-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-3 rounded-full transition-all duration-700",style:{width:`${t.calls.distribution.sonnet}%`}})}),e.jsxs("div",{className:"text-xs text-purple-700",children:["RDV, commandes, support complexe â€¢ ",e.jsx("strong",{children:"3â‚¬/1M tokens"})," (prÃ©cision max)"]})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’¡"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-blue-900 text-sm",children:"Benchmark optimal : 70% Haiku / 30% Sonnet"}),e.jsx("div",{className:"text-xs text-blue-700 mt-1",children:parseFloat(t.calls.distribution.haiku)>=70?"âœ… Excellent ! Vous Ãªtes au-dessus de l'optimal industrie.":`âš ï¸ Potentiel: ${(70-parseFloat(t.calls.distribution.haiku)).toFixed(0)}% de conversations supplÃ©mentaires pourraient utiliser Haiku`})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:"ðŸ’¾ Performance du Cache"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1",children:"Cache Hits"}),e.jsx("div",{className:"text-3xl font-bold text-green-700",children:t.cache.hits}),e.jsx("div",{className:"text-xs text-green-600 mt-1",children:"Appels Ã©conomisÃ©s"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-blue-600 mb-1",children:"En Cache"}),e.jsx("div",{className:"text-3xl font-bold text-blue-700",children:t.cache.size}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"RÃ©ponses mÃ©morisÃ©es"})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-purple-600 mb-1",children:"Hit Rate"}),e.jsxs("div",{className:"text-3xl font-bold text-purple-700",children:[t.cache.hitRate,"%"]}),e.jsx("div",{className:"text-xs text-purple-600 mt-1",children:"Taux de rÃ©ussite"})]}),e.jsxs("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-xs text-cyan-600 mb-1",children:"Tokens Ã‰co."}),e.jsx("div",{className:"text-3xl font-bold text-cyan-700",children:t.tokens.saved.toLocaleString()}),e.jsx("div",{className:"text-xs text-cyan-600 mt-1",children:"Via optimisation"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:"ðŸŽ¯"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-yellow-900 text-sm",children:"Objectif cache : 30%+ hit rate"}),e.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:parseFloat(t.cache.hitRate)>=30?"âœ… Excellent taux de cache ! Les FAQ sont bien couvertes.":`âš ï¸ ${(30-parseFloat(t.cache.hitRate)).toFixed(0)}% de marge - PrÃ©-cacher les questions frÃ©quentes (horaires, prix, services)`})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:"ðŸ“ˆ Tendances d'ActivitÃ©"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:`rounded-lg p-4 border ${l.activity.trend==="increasing"?"bg-green-50 border-green-200":l.activity.trend==="decreasing"?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:"text-xs opacity-70 mb-1",children:"Tendance"}),e.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[l.activity.trend==="increasing"?"ðŸ“ˆ":l.activity.trend==="decreasing"?"ðŸ“‰":"âž¡ï¸",l.activity.trend==="increasing"?"Hausse":l.activity.trend==="decreasing"?"Baisse":"Stable"]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-blue-600 mb-1",children:"Cette heure"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[l.activity.lastHour," conv."]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-xs text-purple-600 mb-1",children:"Moyenne/heure"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:l.activity.perHour})]})]})]})]})]}),a.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 p-6 text-white",children:[e.jsx("h3",{className:"text-xl font-bold flex items-center gap-2",children:"ðŸŽ¯ OpportunitÃ©s d'Optimisation"}),e.jsxs("p",{className:"text-amber-100 text-sm mt-1",children:[a.filter(s=>s.priority==="HIGH").length," prioritaires,"," ",a.filter(s=>s.saving).length," avec Ã©conomies chiffrÃ©es"]})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[a.map((s,r)=>e.jsxs("div",{className:`border-2 rounded-xl p-5 transition-all hover:shadow-md ${g[s.priority]}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${u[s.priority]}`,children:s.priority}),e.jsx("span",{className:"text-xs opacity-60 px-2 py-1 bg-white/50 rounded",children:s.category})]}),e.jsx("div",{className:"font-semibold text-lg mb-2",children:s.title}),e.jsx("div",{className:"text-sm opacity-80 mb-3",children:s.description}),e.jsxs("div",{className:"text-sm font-medium bg-white/50 rounded-lg p-3",children:["ðŸ’¡ ",e.jsx("strong",{children:"Action :"})," ",s.action]})]}),s.saving&&e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-xs opacity-60 mb-1",children:"Ã‰conomie potentielle"}),e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[s.saving,"â‚¬"]}),e.jsx("div",{className:"text-xs text-green-600",children:"/mois"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4 pt-4 border-t border-current border-opacity-20 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-60",children:"Effort :"}),e.jsx("span",{className:`font-semibold ${s.effort==="Low"?"text-green-700":s.effort==="Medium"?"text-yellow-700":"text-red-700"}`,children:s.effort})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"opacity-60",children:"Impact :"}),e.jsx("span",{className:`font-semibold ${s.impact==="High"?"text-green-700":s.impact==="Medium"?"text-yellow-700":"text-blue-700"}`,children:s.impact})]})]})]},r)),e.jsx("div",{className:"mt-6 pt-6 border-t-2 border-dashed",children:e.jsxs("div",{className:"flex items-center justify-between bg-green-50 border-2 border-green-300 rounded-xl p-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-green-800",children:"ðŸ’° Ã‰conomies Totales Potentielles"}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"En appliquant toutes les optimisations recommandÃ©es"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-bold text-green-600",children:[a.filter(s=>s.saving).reduce((s,r)=>s+parseFloat(r.saving||"0"),0).toFixed(2),"â‚¬"]}),e.jsx("div",{className:"text-sm text-green-600",children:"/mois"})]})]})})]})]})]})}export{N as default};
