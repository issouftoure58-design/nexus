import{r as d,j as e,C as F,X as O}from"./index-_yXYEqcL.js";import{A as _}from"./AdminLayout-CTeGiCEF.js";import{C as q}from"./check-B1pij6wq.js";import{C as k}from"./clock-xh9IAeUk.js";import{C}from"./calendar-NWhThMGY.js";import{P as E}from"./plus-D6ktc07k.js";import{T as S}from"./trash-2-CXbRkBbN.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./user-Ai5-1aUm.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";function ne(){const[o,u]=d.useState("horaires"),[x,j]=d.useState([]),[g,z]=d.useState([]),[h,D]=d.useState([]),[A,y]=d.useState(!0),[v,N]=d.useState(!1),[m,w]=d.useState({type:"",text:""}),[i,p]=d.useState({date_debut:"",date_fin:"",motif:""}),[a,l]=d.useState({date:"",heure_debut:"",heure_fin:"",motif:""});d.useEffect(()=>{c()},[o]);const c=async()=>{y(!0);try{const r=localStorage.getItem("admin_token");if(o==="horaires"){const n=await(await fetch("/api/admin/disponibilites/horaires",{headers:{Authorization:`Bearer ${r}`}})).json();j(n.horaires)}else if(o==="conges"){const n=await(await fetch("/api/admin/disponibilites/conges",{headers:{Authorization:`Bearer ${r}`}})).json();z(n.conges)}else if(o==="blocs"){const n=await(await fetch("/api/admin/disponibilites/blocs",{headers:{Authorization:`Bearer ${r}`}})).json();D(n.blocs)}}catch(r){console.error("Erreur chargement données:",r),s("error","Erreur lors du chargement des données")}finally{y(!1)}},s=(r,t)=>{w({type:r,text:t}),setTimeout(()=>w({type:"",text:""}),5e3)},b=(r,t,n)=>{j(x.map(f=>f.jour===r?{...f,[t]:n}:f))},B=async()=>{N(!0);try{const r=localStorage.getItem("admin_token");if(!(await fetch("/api/admin/disponibilites/horaires",{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({horaires:x})})).ok)throw new Error("Erreur sauvegarde");s("success","Horaires enregistrés avec succès")}catch{s("error","Erreur lors de l'enregistrement")}finally{N(!1)}},$=async r=>{if(r.preventDefault(),!i.date_debut||!i.date_fin){s("error","Veuillez remplir les dates");return}if(new Date(i.date_fin)<new Date(i.date_debut)){s("error","La date de fin doit être après la date de début");return}try{const t=localStorage.getItem("admin_token");if(!(await fetch("/api/admin/disponibilites/conges",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Erreur création");s("success","Congé ajouté avec succès"),p({date_debut:"",date_fin:"",motif:""}),c()}catch{s("error","Erreur lors de l'ajout du congé")}},T=async r=>{if(confirm("Supprimer ce congé ?"))try{const t=localStorage.getItem("admin_token");if(!(await fetch(`/api/admin/disponibilites/conges/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)throw new Error("Erreur suppression");s("success","Congé supprimé"),c()}catch{s("error","Erreur lors de la suppression")}},H=async r=>{if(r.preventDefault(),!a.date||!a.heure_debut||!a.heure_fin){s("error","Veuillez remplir tous les champs");return}if(a.heure_fin<=a.heure_debut){s("error","L'heure de fin doit être après l'heure de début");return}try{const t=localStorage.getItem("admin_token");if(!(await fetch("/api/admin/disponibilites/blocs",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Erreur création");s("success","Bloc ajouté avec succès"),l({date:"",heure_debut:"",heure_fin:"",motif:""}),c()}catch{s("error","Erreur lors de l'ajout du bloc")}},L=async r=>{if(confirm("Supprimer ce bloc d'indisponibilité ?"))try{const t=localStorage.getItem("admin_token");if(!(await fetch(`/api/admin/disponibilites/blocs/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}})).ok)throw new Error("Erreur suppression");s("success","Bloc supprimé"),c()}catch{s("error","Erreur lors de la suppression")}},I=r=>{const t=new Date().toISOString().split("T")[0];return t>=r.date_debut&&t<=r.date_fin};return A?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-gray-500",children:"Chargement..."})})}):e.jsx(_,{children:e.jsxs("div",{className:"p-3 md:p-6",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Disponibilités"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm md:text-base",children:"Gérez vos horaires, congés et indisponibilités"})]}),m.text&&e.jsxs("div",{className:`
            mb-6 p-4 rounded-lg flex items-center gap-3
            ${m.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}
          `,children:[m.type==="success"?e.jsx(q,{size:20}):e.jsx(F,{size:20}),e.jsx("span",{children:m.text})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-2 mb-8 border-b border-gray-200 overflow-x-auto",children:[e.jsx("button",{onClick:()=>u("horaires"),className:`
              px-3 md:px-6 py-2 md:py-3 font-medium transition border-b-2 text-sm md:text-base whitespace-nowrap
              ${o==="horaires"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}
            `,children:e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx(k,{size:16,className:"md:w-[18px] md:h-[18px]"}),e.jsx("span",{className:"hidden sm:inline",children:"Horaires hebdomadaires"}),e.jsx("span",{className:"sm:hidden",children:"Horaires"})]})}),e.jsx("button",{onClick:()=>u("conges"),className:`
              px-3 md:px-6 py-2 md:py-3 font-medium transition border-b-2 text-sm md:text-base whitespace-nowrap
              ${o==="conges"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}
            `,children:e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx(C,{size:16,className:"md:w-[18px] md:h-[18px]"}),"Congés"]})}),e.jsx("button",{onClick:()=>u("blocs"),className:`
              px-3 md:px-6 py-2 md:py-3 font-medium transition border-b-2 text-sm md:text-base whitespace-nowrap
              ${o==="blocs"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}
            `,children:e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx(O,{size:16,className:"md:w-[18px] md:h-[18px]"}),"Blocs"]})})]}),o==="horaires"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Horaires de la semaine"}),e.jsx("div",{className:"space-y-3 mb-6",children:x.map(r=>e.jsxs("div",{className:`
                    p-3 md:p-4 rounded-lg border-2 transition
                    ${r.is_active?"border-purple-200 bg-purple-50":"border-gray-200 bg-gray-50"}
                  `,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 md:mb-0",children:[e.jsx("input",{type:"checkbox",checked:r.is_active,onChange:t=>b(r.jour,"is_active",t.target.checked),className:"w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500 flex-shrink-0"}),e.jsx("span",{className:`font-medium ${r.is_active?"text-gray-800":"text-gray-400"}`,children:r.nom}),!r.is_active&&e.jsx("span",{className:"text-gray-400 italic text-sm ml-auto",children:"Fermé"})]}),r.is_active&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 mt-2 ml-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"De"}),e.jsx("input",{type:"time",value:r.heure_debut||"",onChange:t=>b(r.jour,"heure_debut",t.target.value),className:"px-2 md:px-3 py-1.5 md:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"à"}),e.jsx("input",{type:"time",value:r.heure_fin||"",onChange:t=>b(r.jour,"heure_fin",t.target.value),className:"px-2 md:px-3 py-1.5 md:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm md:text-base"})]})]})]},r.jour))}),e.jsx("button",{onClick:B,disabled:v,className:"w-full bg-gradient-to-r from-purple-600 to-pink-500 text-white py-3 px-6 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 transition disabled:opacity-50",children:v?"Enregistrement...":"Enregistrer les horaires"})]}),o==="conges"&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Ajouter un congé"}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de début"}),e.jsx("input",{type:"date",value:i.date_debut,onChange:r=>p({...i,date_debut:r.target.value}),className:"w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),e.jsx("input",{type:"date",value:i.date_fin,onChange:r=>p({...i,date_fin:r.target.value}),className:"w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motif (optionnel)"}),e.jsx("input",{type:"text",value:i.motif,onChange:r=>p({...i,motif:r.target.value}),placeholder:"Ex: Vacances, Formation...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 transition",children:[e.jsx(E,{size:20}),"Ajouter le congé"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:["Congés planifiés (",g.length,")"]}),g.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Aucun congé planifié"}):e.jsx("div",{className:"space-y-3",children:g.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-purple-200 transition",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{size:18,className:"text-purple-600"}),e.jsxs("span",{className:"font-medium text-gray-800",children:["Du ",new Date(r.date_debut).toLocaleDateString("fr-FR")," au ",new Date(r.date_fin).toLocaleDateString("fr-FR")]}),I(r)&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:"En cours"})]}),r.motif&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 ml-9",children:r.motif})]}),e.jsx("button",{onClick:()=>T(r.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:e.jsx(S,{size:18})})]},r.id))})]})]}),o==="blocs"&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Ajouter un bloc d'indisponibilité"}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:a.date,onChange:r=>l({...a,date:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Heure de début"}),e.jsx("input",{type:"time",value:a.heure_debut,onChange:r=>l({...a,heure_debut:r.target.value}),className:"w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Heure de fin"}),e.jsx("input",{type:"time",value:a.heure_fin,onChange:r=>l({...a,heure_fin:r.target.value}),className:"w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motif (optionnel)"}),e.jsx("input",{type:"text",value:a.motif,onChange:r=>l({...a,motif:r.target.value}),placeholder:"Ex: RDV médecin, Formation...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 transition",children:[e.jsx(E,{size:20}),"Ajouter le bloc"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:["Blocs d'indisponibilité (",h.length,")"]}),h.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Aucun bloc d'indisponibilité"}):e.jsx("div",{className:"space-y-3",children:h.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:border-purple-200 transition",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{size:18,className:"text-purple-600"}),e.jsxs("span",{className:"font-medium text-gray-800",children:[new Date(r.date).toLocaleDateString("fr-FR")," - ",r.heure_debut," à ",r.heure_fin]})]}),r.motif&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 ml-9",children:r.motif})]}),e.jsx("button",{onClick:()=>L(r.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:e.jsx(S,{size:18})})]},r.id))})]})]})]})})}export{ne as default};
