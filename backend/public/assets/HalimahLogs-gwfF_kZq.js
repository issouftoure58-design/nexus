import{r as a,j as e,C as y}from"./index-_yXYEqcL.js";import{A as C}from"./AdminLayout-CTeGiCEF.js";import{a as k}from"./settings-BkyowQvs.js";import{C as h}from"./calendar-NWhThMGY.js";import{B as n}from"./brain-C9qc7Lcl.js";import{M as S}from"./message-square-BHRNNhOm.js";import{C as p}from"./circle-check-big-BOhRDXR_.js";import{C as L}from"./circle-x-CE1ZE8zE.js";import{S as A}from"./scissors-DPHsfmq1.js";import{U as M}from"./user-Ai5-1aUm.js";import{P as B}from"./phone-DqBiH1an.js";import{C as T}from"./clock-xh9IAeUk.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";const u={confirme:{label:"Confirmé",color:"text-green-400 bg-green-500/20",icon:p},demande:{label:"En attente",color:"text-amber-400 bg-amber-500/20",icon:y},annule:{label:"Annulé",color:"text-red-400 bg-red-500/20",icon:L},termine:{label:"Terminé",color:"text-blue-400 bg-blue-500/20",icon:p}};function Y(){const[o,f]=a.useState([]),[c,g]=a.useState([]),[r,j]=a.useState(""),[w,N]=a.useState(!0),[i,m]=a.useState("bookings");a.useEffect(()=>{const t=localStorage.getItem("admin_token");fetch("/api/admin/halimah/logs",{headers:{Authorization:`Bearer ${t}`}}).then(s=>s.json()).then(s=>{s.success&&(f(s.recent_bookings||[]),g(s.memories||[]))}).catch(console.error).finally(()=>N(!1))},[]);const x=o.filter(t=>!r||t.client?.toLowerCase().includes(r.toLowerCase())||t.telephone?.includes(r)||t.service?.toLowerCase().includes(r.toLowerCase())),d=c.filter(t=>!r||t.key?.toLowerCase().includes(r.toLowerCase())||t.value?.toLowerCase().includes(r.toLowerCase())),l=t=>{try{return new Date(t).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}catch{return t}},b=t=>{try{return new Date(t).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}catch{return""}};return e.jsx(C,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Logs Halimah"}),e.jsx("p",{className:"text-white/50 text-sm",children:"Historique des interactions et réservations"})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(k,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-white/40"}),e.jsx("input",{type:"text",value:r,onChange:t=>j(t.target.value),placeholder:"Rechercher par client, service, téléphone...",className:"w-full pl-10 pr-4 py-2.5 bg-zinc-900/80 border border-white/10 rounded-xl text-white placeholder:text-white/30 outline-none focus:border-amber-500/50"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>m("bookings"),className:`px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2 ${i==="bookings"?"bg-gradient-to-r from-amber-500 to-orange-500 text-white":"bg-white/5 border border-white/10 text-white/60 hover:text-white"}`,children:[e.jsx(h,{className:"w-4 h-4"}),"Réservations (",o.length,")"]}),e.jsxs("button",{onClick:()=>m("memories"),className:`px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-2 ${i==="memories"?"bg-gradient-to-r from-amber-500 to-orange-500 text-white":"bg-white/5 border border-white/10 text-white/60 hover:text-white"}`,children:[e.jsx(n,{className:"w-4 h-4"}),"Mémoire IA (",c.length,")"]})]})]}),w?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-500"})}):i==="bookings"?e.jsx("div",{className:"space-y-3",children:x.length===0?e.jsxs("div",{className:"text-center py-16 text-white/40",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"Aucune réservation trouvée"})]}):x.map(t=>{const s=u[t.statut]||u.demande,v=s.icon;return e.jsx("div",{className:"bg-zinc-900/80 border border-white/10 rounded-2xl p-4 hover:border-amber-500/20 transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500/20 to-orange-500/20 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(A,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:t.service||"Service non spécifié"}),e.jsxs("span",{className:`flex items-center gap-1.5 text-xs px-2.5 py-1 rounded-full shrink-0 ${s.color}`,children:[e.jsx(v,{className:"w-3 h-3"}),s.label]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-sm text-white/50",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(M,{className:"w-3.5 h-3.5"}),t.client||"Client inconnu"]}),t.telephone&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(B,{className:"w-3.5 h-3.5"}),t.telephone]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(h,{className:"w-3.5 h-3.5"}),l(t.date)," ",t.heure&&`à ${t.heure}`]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(T,{className:"w-3.5 h-3.5"}),"Créé le ",l(t.created_at)," ",b(t.created_at)]})]}),t.notes&&e.jsxs("p",{className:"mt-2 text-xs text-white/30 italic",children:["Note: ",t.notes]})]})]})},t.id)})}):e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsxs("div",{className:"text-center py-16 text-white/40",children:[e.jsx(n,{className:"w-12 h-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{children:"Aucune mémoire trouvée"})]}):d.map(t=>e.jsx("div",{className:"bg-zinc-900/80 border border-white/10 rounded-2xl p-4 hover:border-purple-500/20 transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(n,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 bg-purple-500/20 text-purple-300 rounded-full",children:t.type}),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-white/10 text-white/50 rounded-full",children:t.category}),e.jsx("span",{className:"text-xs text-white/30 ml-auto",children:l(t.created_at)})]}),e.jsx("h4",{className:"text-white font-medium text-sm",children:t.key}),e.jsx("p",{className:"text-white/50 text-sm mt-1",children:t.value}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("div",{className:"h-1.5 w-20 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${(t.confidence||.5)*100}%`}})}),e.jsxs("span",{className:"text-xs text-white/30",children:["Confiance: ",Math.round((t.confidence||.5)*100),"%"]})]})]})]})},t.id))})]})})}export{Y as default};
