import{r as l,j as e}from"./index-_yXYEqcL.js";const N=()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")}`});function w(){const[x,u]=l.useState([]),[a,h]=l.useState(null),[d,o]=l.useState(!1),[c,g]=l.useState("all"),[i,p]=l.useState(!1),b=l.useRef(null);l.useEffect(()=>{m();const s=setInterval(()=>{i||m()},2e3);return()=>clearInterval(s)},[i,c]);const m=async()=>{try{const s=new URLSearchParams({limit:"50"});c!=="all"&&s.append("type",c);const t=await fetch(`/api/sentinel/live/events?${s}`,{headers:N()});if(t.ok){const r=await t.json();u(r.events||[]),h(r.stats),o(!0)}else o(!1)}catch{o(!1)}},f=s=>({ai:"bg-purple-100 text-purple-800 border-purple-300",system:"bg-blue-100 text-blue-800 border-blue-300",performance:"bg-green-100 text-green-800 border-green-300",security:"bg-red-100 text-red-800 border-red-300",financial:"bg-yellow-100 text-yellow-800 border-yellow-300",error:"bg-red-200 text-red-900 border-red-400"})[s]||"bg-gray-100 text-gray-800 border-gray-300",v=s=>{const t=new Date,r=new Date(s),n=Math.floor((t.getTime()-r.getTime())/1e3);return n<5?"maintenant":n<60?`il y a ${n}s`:n<3600?`il y a ${Math.floor(n/60)}min`:r.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})},j=[{value:"all",label:"Tous",icon:"ğŸ“Š"},{value:"conversation",label:"Conversations",icon:"ğŸ’¬"},{value:"optimization",label:"Optimisations",icon:"âš¡"},{value:"cache",label:"Cache",icon:"ğŸ’¾"},{value:"cost",label:"CoÃ»ts",icon:"ğŸ’°"},{value:"security",label:"SÃ©curitÃ©",icon:"ğŸ›¡ï¸"},{value:"error",label:"Erreurs",icon:"âš ï¸"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-blue-600 to-cyan-500 rounded-xl p-6 text-white shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-5xl animate-pulse",children:"ğŸ«€"}),d&&e.jsxs("span",{className:"absolute -top-1 -right-1 flex h-4 w-4",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-4 w-4 bg-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"NEXUS PULSE"}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Flux d'Ã©vÃ©nements temps rÃ©el"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full ${d?"bg-green-500/20":"bg-red-500/20"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-green-400 animate-pulse":"bg-red-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:d?"LIVE":"Offline"})]}),e.jsx("button",{onClick:()=>p(!i),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${i?"bg-yellow-500/30 text-yellow-100":"bg-white/10 hover:bg-white/20"}`,children:i?"â–¶ï¸ Reprendre":"â¸ï¸ Pause"})]})]}),a?.session&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-200",children:"Conversations"}),e.jsx("div",{className:"text-xl font-bold",children:a.session.totalConversations})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-200",children:"Cache Hits"}),e.jsx("div",{className:"text-xl font-bold",children:a.session.totalCacheHits})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-200",children:"Haiku %"}),e.jsxs("div",{className:"text-xl font-bold",children:[a.session.haikuPercentage,"%"]})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-200",children:"Ã‰conomies"}),e.jsxs("div",{className:"text-xl font-bold text-green-300",children:[a.session.totalSavings.toFixed(2),"â‚¬"]})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-purple-200",children:"DerniÃ¨re 1min"}),e.jsxs("div",{className:"text-xl font-bold",children:[a.last1min," Ã©vts"]})]})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:j.map(s=>e.jsxs("button",{onClick:()=>g(s.value),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${c===s.value?"bg-purple-600 text-white shadow-md":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-200"}`,children:[s.icon," ",s.label,a?.byType?.[s.value]&&e.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 rounded-full bg-black/10 text-xs",children:a.byType[s.value]})]},s.value))}),e.jsx("div",{ref:b,className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:x.length===0?e.jsxs("div",{className:"p-16 text-center text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:"â³"}),e.jsx("div",{className:"text-lg font-medium",children:"En attente d'Ã©vÃ©nements..."}),e.jsx("div",{className:"text-sm mt-2",children:"Les Ã©vÃ©nements apparaÃ®tront ici dÃ¨s qu'une conversation aura lieu"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:x.map((s,t)=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-all ${t===0&&!i?"animate-slideIn bg-blue-50/50":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl flex-shrink-0 pt-0.5",children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold border ${f(s.category)}`,children:s.type}),s.channel&&e.jsx("span",{className:"px-2 py-0.5 rounded bg-gray-100 text-gray-600 text-xs",children:s.channel})]}),e.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:v(s.timestamp)})]}),e.jsx("div",{className:"font-medium text-gray-900 mb-1",children:s.action}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-0.5",children:[s.question&&e.jsxs("div",{className:"text-gray-500 truncate italic",children:['"',s.question,'..."']}),s.model&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${s.model==="Haiku"?"bg-green-500":"bg-purple-500"}`}),"ModÃ¨le: ",s.model]}),s.tokens!==void 0&&s.tokens>0&&e.jsxs("div",{children:["ğŸ¯ ",s.tokens.toLocaleString()," tokens"]}),s.responseTime&&e.jsxs("div",{children:["â±ï¸ ",s.responseTime]}),s.cost!==void 0&&parseFloat(s.cost)>0&&e.jsxs("div",{className:"font-semibold text-purple-600",children:["ğŸ’³ CoÃ»t: ",s.cost,"â‚¬"]}),s.saving!==void 0&&parseFloat(s.saving)>0&&e.jsxs("div",{className:"font-semibold text-green-600",children:["ğŸ’š Ã‰conomie: ",s.saving,"â‚¬ (",s.percentage,"%)"]}),s.tokensSaved!==void 0&&s.tokensSaved>0&&e.jsxs("div",{className:"text-green-600",children:["âœ‚ï¸ -",s.tokensSaved," tokens (",s.percentage,"%)"]}),s.reason&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["ğŸ’¡ ",s.reason]}),s.cacheHits!==void 0&&e.jsxs("div",{className:"text-cyan-600",children:["ğŸ“Š ",s.cacheHits," hits prÃ©cÃ©dents"]}),s.errorMessage&&e.jsx("div",{className:"text-red-600 text-xs bg-red-50 p-2 rounded mt-1",children:s.errorMessage})]})]})]})},s.id))})})})]})}export{w as default};
