import{c as w,r,j as e,L as j,C as P,X as $,M as q,Q as z}from"./index-_yXYEqcL.js";import{A as N,P as d,M as U}from"./AdminLayout-CTeGiCEF.js";import{C as o}from"./check-B1pij6wq.js";import{E as G}from"./euro-BOxFFLgt.js";import{L as y}from"./lock-CdiT9bM9.js";import{I as v}from"./info-CfaX-go2.js";import{S as O}from"./shield-DwVSybTP.js";import{a as F}from"./settings-BkyowQvs.js";import{C as R}from"./calculator-Cx4UFn2M.js";import{U as T}from"./users-DLPfMp13.js";import{S as D}from"./scissors-DPHsfmq1.js";import{S as H}from"./shopping-bag-CEo4UOGG.js";import{C as Q}from"./credit-card-BzWzjUVE.js";import{G as V}from"./globe-DUPEMez9.js";import{C as X}from"./calendar-NWhThMGY.js";import{P as Z}from"./phone-DqBiH1an.js";import{B as J}from"./building-2-vzz2bg68.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./user-Ai5-1aUm.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=w("Stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=w("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]),Y={Building2:J,Bot:z,MessageCircle:q,Phone:Z,Calendar:X,Globe:V,CreditCard:Q,ShoppingBag:H,Scissors:D,UtensilsCrossed:W,Stethoscope:K,Users:T,Calculator:R,Megaphone:U,Search:F,Shield:O,Package:d},ee={base:"Socle",canaux_clients:"Canaux Clients",outils_business:"Outils Business",modules_metier:"Modules Métier",modules_avances:"Modules Avancés"};function ke(){const[x,C]=r.useState([]),[n,_]=r.useState(null),[k,S]=r.useState(!0),[M,h]=r.useState(null),[g,l]=r.useState(null),[u,m]=r.useState(null);r.useEffect(()=>{p(),f()},[]);const p=async()=>{try{const t=localStorage.getItem("admin_token"),a=await fetch("/api/admin/modules",{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error("Erreur lors du chargement");const s=await a.json();C(s.modules||[]),l(null)}catch(t){l(t.message)}finally{S(!1)}},f=async()=>{try{const t=localStorage.getItem("admin_token"),a=await fetch("/api/admin/modules/pricing",{headers:{Authorization:`Bearer ${t}`}});if(a.ok){const s=await a.json();_(s)}}catch(t){console.error("Erreur pricing:",t)}},L=async(t,a)=>{h(t),l(null),m(null);try{const s=localStorage.getItem("admin_token"),i=await fetch(`/api/admin/modules/${t}/${a?"activate":"deactivate"}`,{method:"POST",headers:{Authorization:`Bearer ${s}`}}),c=await i.json();if(!i.ok)throw new Error(c.error||"Erreur lors de l'opération");m(c.message),p(),f(),setTimeout(()=>m(null),3e3)}catch(s){l(s.message)}finally{h(null)}},A=x.reduce((t,a)=>{const s=a.categorie;return t[s]||(t[s]=[]),t[s].push(a),t},{}),E=["base","canaux_clients","outils_business","modules_metier","modules_avances"],B=t=>Y[t]||d;return k?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(j,{className:"w-8 h-8 animate-spin text-amber-500"})})}):e.jsx(N,{children:e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mes Modules"}),e.jsx("p",{className:"text-gray-500",children:"Gérez les fonctionnalités activées pour votre compte"})]})}),g&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700",children:g})]}),u&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),e.jsx("p",{className:"text-green-700",children:u})]}),n&&e.jsx("div",{className:"mb-8 bg-gradient-to-r from-amber-500 to-orange-500 rounded-xl p-6 text-white shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-100 text-sm font-medium",children:"Coût mensuel actuel"}),e.jsxs("p",{className:"text-4xl font-bold mt-1",children:[n.total_euros,"€",e.jsx("span",{className:"text-lg font-normal",children:"/mois"})]}),e.jsxs("p",{className:"text-amber-100 text-sm mt-2",children:[n.modules.length," module",n.modules.length>1?"s":""," actif",n.modules.length>1?"s":""]})]}),e.jsx(G,{className:"w-16 h-16 text-amber-200 opacity-50"})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[e.jsx(d,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Aucun module disponible"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Les modules seront bientôt disponibles."})]}),E.map(t=>{const a=A[t];return!a||a.length===0?null:e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${t==="base"?"bg-purple-500":t==="canaux_clients"?"bg-blue-500":t==="outils_business"?"bg-green-500":t==="modules_metier"?"bg-amber-500":"bg-gray-500"}`}),ee[t]||t]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(s=>{const b=B(s.icone),i=M===s.id;return e.jsxs("div",{className:`relative rounded-xl border-2 p-5 transition-all ${s.est_actif?"border-green-500 bg-green-50/50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[s.est_actif&&e.jsxs("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white text-xs font-medium px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(o,{className:"w-3 h-3"}),"Actif"]}),e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.est_actif?"bg-green-100":"bg-gray-100"}`,children:e.jsx(b,{className:`w-5 h-5 ${s.est_actif?"text-green-600":"text-gray-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.nom}),e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[(s.prix_mensuel/100).toFixed(0),"€",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/mois"})]}),s.requis&&e.jsxs("span",{className:"text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded-full flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),"Requis"]})]}),s.features&&s.features.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("ul",{className:"space-y-1",children:[s.features.slice(0,3).map((c,I)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-center gap-2",children:[e.jsx(o,{className:"w-3 h-3 text-green-500 flex-shrink-0"}),c]},I)),s.features.length>3&&e.jsxs("li",{className:"text-xs text-gray-400",children:["+",s.features.length-3," autres fonctionnalités"]})]})}),s.dependances&&s.dependances.length>0&&!s.est_actif&&e.jsx("div",{className:"mb-4 p-2 bg-amber-50 rounded-lg",children:e.jsxs("p",{className:"text-xs text-amber-700 flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"}),"Nécessite: ",s.dependances.join(", ")]})}),e.jsx("button",{onClick:()=>L(s.id,!s.est_actif),disabled:i||s.requis&&s.est_actif,className:`w-full py-2 px-4 rounded-lg font-medium text-sm transition-colors flex items-center justify-center gap-2 ${s.requis&&s.est_actif?"bg-gray-100 text-gray-400 cursor-not-allowed":s.est_actif?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-500 text-white hover:bg-green-600"}`,children:i?e.jsx(j,{className:"w-4 h-4 animate-spin"}):s.requis&&s.est_actif?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4"}),"Module obligatoire"]}):s.est_actif?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"}),"Désactiver"]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-4 h-4"}),"Activer"]})})]},s.id)})})]},t)}),e.jsx("div",{className:"mt-8 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Comment ça marche ?"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Activez ou désactivez les modules selon vos besoins. Le coût mensuel sera ajusté automatiquement. Certains modules dépendent d'autres modules qui doivent être activés en premier."})]})]})})]})})}export{ke as default};
