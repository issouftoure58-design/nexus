import{a as T,r as o,j as e,B as d,C as z}from"./index-_yXYEqcL.js";import{A as E,S as M}from"./AdminLayout-CTeGiCEF.js";import{I as n}from"./input-TVuV-KxK.js";import{T as j}from"./textarea-C1wLWZvj.js";import{S as D}from"./settings-BkyowQvs.js";import{R as p}from"./rotate-ccw-CMY3EDTH.js";import{S as F}from"./save-B2MQZ1Te.js";import{C as S}from"./calculator-Cx4UFn2M.js";import{C as V}from"./credit-card-BzWzjUVE.js";import{C as B}from"./circle-x-CE1ZE8zE.js";import{M as q}from"./message-square-BHRNNhOm.js";import{E as f}from"./eye-CvXJPXHv.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./user-Ai5-1aUm.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";function xe(){const{toast:m}=T(),[O,A]=o.useState({}),[P,N]=o.useState(!0),[y,w]=o.useState(!1),[c,_]=o.useState("salon"),[u,b]=o.useState({}),k=[{id:"salon",name:"Infos Fatou",icon:M},{id:"tarification",name:"Tarification",icon:S},{id:"paiement",name:"Paiement",icon:V},{id:"annulation",name:"Annulation",icon:B},{id:"messages",name:"Messages",icon:q}];o.useEffect(()=>{v()},[]);const v=async()=>{N(!0);try{const s=localStorage.getItem("admin_token"),t=await fetch("/api/admin/parametres",{headers:{Authorization:`Bearer ${s}`}});if(!t.ok)throw new Error("Erreur lors du chargement");const i=await t.json();A(i.parametres||{});const l={};Object.values(i.parametres||{}).forEach(x=>{x.forEach(C=>{l[C.cle]=C.valeur})}),b(l)}catch(s){console.error("Erreur:",s),m({title:"Erreur",description:"Impossible de charger les paramètres",variant:"destructive"})}finally{N(!1)}},r=(s,t)=>{b({...u,[s]:t})},I=async()=>{w(!0);try{const s=localStorage.getItem("admin_token"),t=Object.entries(u).map(([l,x])=>({cle:l,valeur:x}));if(!(await fetch("/api/admin/parametres",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({parametres:t})})).ok)throw new Error("Erreur lors de l'enregistrement");m({title:"Succès",description:"Paramètres enregistrés avec succès"}),v()}catch(s){console.error("Erreur:",s),m({title:"Erreur",description:"Impossible d'enregistrer les paramètres",variant:"destructive"})}finally{w(!1)}},h=async s=>{if(confirm("Réinitialiser ce paramètre à sa valeur par défaut ?"))try{const t=localStorage.getItem("admin_token"),i=await fetch(`/api/admin/parametres/${s}/reset`,{method:"POST",headers:{Authorization:`Bearer ${t}`}});if(!i.ok)throw new Error("Erreur lors du reset");const l=await i.json();b({...u,[s]:l.parametre.valeur}),m({title:"Succès",description:"Paramètre réinitialisé"})}catch(t){console.error("Erreur:",t),m({title:"Erreur",description:"Impossible de réinitialiser le paramètre",variant:"destructive"})}},$=async()=>{if(confirm("Initialiser tous les paramètres par défaut ? (Les valeurs existantes ne seront pas modifiées)"))try{const s=localStorage.getItem("admin_token");if(!(await fetch("/api/admin/parametres/init",{method:"POST",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Erreur lors de l'initialisation");m({title:"Succès",description:"Paramètres initialisés"}),v()}catch(s){console.error("Erreur:",s),m({title:"Erreur",description:"Impossible d'initialiser les paramètres",variant:"destructive"})}},a=s=>u[s]||"",R=()=>{const s=parseFloat(a("frais_base_deplacement"))||0,t=parseFloat(a("seuil_km_gratuit"))||0,i=parseFloat(a("tarif_km_supplementaire"))||0,l=15;if(l<=t)return`Pour ${l}km = ${s.toFixed(2)}€`;{const x=s+(l-t)*i;return`Pour ${l}km = ${s}€ + (${l}-${t}) × ${i}€ = ${x.toFixed(2)}€`}},g=s=>s.replace("{date}","20/01/2026").replace("{heure}","14:00").replace("{client}","Aminata Diallo").replace("{service}","Tresses africaines").replace("{prix}","80€");return P?e.jsx(E,{children:e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})})}):e.jsx(E,{children:e.jsxs("div",{className:"p-3 md:p-8",children:[e.jsx("div",{className:"mb-6 md:mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 md:p-3 bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 md:w-6 md:h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"Paramètres"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base",children:"Configuration de l'activité"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{onClick:$,variant:"outline",size:"sm",className:"text-xs md:text-sm",children:[e.jsx(p,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Initialiser"})]}),e.jsxs(d,{onClick:I,disabled:y,size:"sm",className:"bg-gradient-to-r from-purple-600 to-pink-600 text-xs md:text-sm",children:[e.jsx(F,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),y?"Enregistrement...":"Enregistrer"]})]})]})}),e.jsx("div",{className:"md:hidden mb-4 overflow-x-auto",children:e.jsx("div",{className:"flex gap-2 p-1 bg-gray-100 rounded-lg min-w-max",children:k.map(s=>{const t=s.icon,i=c===s.id;return e.jsxs("button",{onClick:()=>_(s.id),className:`
                    flex items-center gap-1.5 px-3 py-2 rounded-lg transition-colors whitespace-nowrap text-sm
                    ${i?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"text-gray-700"}
                  `,children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:s.name})]},s.id)})})}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"hidden md:block w-64 flex-shrink-0",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-2 space-y-1",children:k.map(s=>{const t=s.icon,i=c===s.id;return e.jsxs("button",{onClick:()=>_(s.id),className:`
                      w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors
                      ${i?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"text-gray-700 hover:bg-gray-100"}
                    `,children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:s.name})]},s.id)})})}),e.jsxs("div",{className:"flex-1 bg-white rounded-lg shadow p-4 md:p-6",children:[c==="salon"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Informations de contact"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Ces informations sont utilisées pour les communications et l'affichage public."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom de l'activité"}),e.jsx(n,{type:"text",value:a("nom_salon"),onChange:s=>r("nom_salon",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adresse complète"}),e.jsx(n,{type:"text",value:a("adresse_salon"),onChange:s=>r("adresse_salon",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Téléphone"}),e.jsx(n,{type:"tel",value:a("telephone_salon"),onChange:s=>r("telephone_salon",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(n,{type:"email",value:a("email_salon"),onChange:s=>r("email_salon",s.target.value)})]})]})]})]}),c==="tarification"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Tarification déplacement"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configuration des frais de déplacement pour les services à domicile."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frais de base (€)"}),e.jsx(n,{type:"number",step:"0.01",min:"0",value:a("frais_base_deplacement"),onChange:s=>r("frais_base_deplacement",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Frais fixes pour les déplacements courts"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Seuil km gratuit"}),e.jsx(n,{type:"number",step:"0.1",min:"0",value:a("seuil_km_gratuit"),onChange:s=>r("seuil_km_gratuit",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Distance sans supplément (km)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarif km supplémentaire (€/km)"}),e.jsx(n,{type:"number",step:"0.01",min:"0",value:a("tarif_km_supplementaire"),onChange:s=>r("tarif_km_supplementaire",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Prix par km au-delà du seuil"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance maximale (km)"}),e.jsx(n,{type:"number",step:"1",min:"1",value:a("distance_max_km"),onChange:s=>r("distance_max_km",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Distance maximale acceptée"})]})]}),e.jsx("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Exemple de calcul"}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:R()})]})]})})]})]}),c==="paiement"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Paiement & Acompte"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configuration des règles de paiement et d'acompte."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant de l'acompte (€)"}),e.jsx(n,{type:"number",step:"0.01",min:"0",value:a("montant_acompte"),onChange:s=>r("montant_acompte",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Montant demandé pour confirmer une réservation"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Acompte obligatoire"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Exiger l'acompte pour confirmer les réservations"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a("acompte_obligatoire")==="true",onChange:s=>r("acompte_obligatoire",s.target.checked?"true":"false"),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]})]})]}),c==="annulation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Politique d'annulation"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configuration des règles d'annulation et de remboursement."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Délai d'annulation gratuite (heures)"}),e.jsx(n,{type:"number",step:"1",min:"1",value:a("delai_annulation_heures"),onChange:s=>r("delai_annulation_heures",s.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nombre d'heures avant le RDV pour annuler gratuitement"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Rembourser si hors délai"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Rembourser l'acompte en cas d'annulation tardive"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a("remboursement_hors_delai")==="true",onChange:s=>r("remboursement_hors_delai",s.target.checked?"true":"false"),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Résumé de la politique"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Annulation gratuite jusqu'à ",a("delai_annulation_heures")," heures avant le RDV.",a("remboursement_hors_delai")==="true"?" Au-delà, l'acompte est remboursé.":" Au-delà, l'acompte est conservé."]})]})]})})]})]}),c==="messages"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Templates de messages"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Personnalisez les messages automatiques envoyés aux clients."})]}),e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg mb-6",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Variables disponibles :"})," ","{date}",", ","{heure}",", ","{client}",", ","{service}",", ","{prix}"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message de confirmation"}),e.jsxs(d,{onClick:()=>h("msg_confirmation"),variant:"ghost",size:"sm",className:"text-purple-600",children:[e.jsx(p,{className:"w-4 h-4 mr-1"}),"Réinitialiser"]})]}),e.jsx(j,{value:a("msg_confirmation"),onChange:s=>r("msg_confirmation",s.target.value),rows:2}),e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Aperçu :"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:g(a("msg_confirmation"))})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message de rappel (J-1)"}),e.jsxs(d,{onClick:()=>h("msg_rappel_j1"),variant:"ghost",size:"sm",className:"text-purple-600",children:[e.jsx(p,{className:"w-4 h-4 mr-1"}),"Réinitialiser"]})]}),e.jsx(j,{value:a("msg_rappel_j1"),onChange:s=>r("msg_rappel_j1",s.target.value),rows:2}),e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Aperçu :"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:g(a("msg_rappel_j1"))})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message d'annulation"}),e.jsxs(d,{onClick:()=>h("msg_annulation"),variant:"ghost",size:"sm",className:"text-purple-600",children:[e.jsx(p,{className:"w-4 h-4 mr-1"}),"Réinitialiser"]})]}),e.jsx(j,{value:a("msg_annulation"),onChange:s=>r("msg_annulation",s.target.value),rows:2}),e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Aperçu :"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:g(a("msg_annulation"))})]})]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message de remerciement (J+1)"}),e.jsxs(d,{onClick:()=>h("msg_remerciement"),variant:"ghost",size:"sm",className:"text-purple-600",children:[e.jsx(p,{className:"w-4 h-4 mr-1"}),"Réinitialiser"]})]}),e.jsx(j,{value:a("msg_remerciement"),onChange:s=>r("msg_remerciement",s.target.value),rows:2}),e.jsx("div",{className:"mt-2 p-3 bg-gray-50 rounded border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(f,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Aperçu :"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:g(a("msg_remerciement"))})]})]})})]})]})]})]})]})]})})}export{xe as default};
