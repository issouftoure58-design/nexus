import{c as M,r as l,j as e}from"./index-_yXYEqcL.js";import{A as C,a as A}from"./AdminLayout-CTeGiCEF.js";import{C as H}from"./chevron-left-DzjsD1u5.js";import{C as E}from"./chevron-right-DPdOXaL5.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./user-Ai5-1aUm.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./log-out-CvuSphzZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=M("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),g=64,f=7,F=19,k=Array.from({length:F-f+1},(r,a)=>f+a),I=["Lun","Mar","Mer","Jeu","Ven","Sam"];function O(r){const a=new Date,i=a.getDay(),c=a.getDate()-i+(i===0?-6:1)+r*7;return new Date(a.getFullYear(),a.getMonth(),c)}function m(r){const a=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),c=String(r.getDate()).padStart(2,"0");return`${a}-${i}-${c}`}function T(r){return r.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}function B(r){switch(r){case"confirme":return"bg-green-500/20 border-green-500 text-green-300";case"en_attente":case"demande":return"bg-amber-500/20 border-amber-500 text-amber-300";case"en_attente_paiement":return"bg-blue-500/20 border-blue-500 text-blue-300";case"termine":return"bg-zinc-500/20 border-zinc-500 text-zinc-400";case"annule":case"no_show":return"bg-red-500/20 border-red-500 text-red-300";default:return"bg-zinc-500/20 border-zinc-500 text-zinc-300"}}function p(r){const[a,i]=r.split(":");return i==="00"?`${parseInt(a)}h`:`${parseInt(a)}h${i}`}function U(r,a){const[i,c]=r.split(":").map(Number),h=i*60+c+a,b=Math.floor(h/60),d=h%60;return`${b}:${d.toString().padStart(2,"0")}`}function ie(){const[r,a]=l.useState(0),[i,c]=l.useState([]),[h,b]=l.useState(!0),d=l.useMemo(()=>O(r),[r]),x=l.useMemo(()=>Array.from({length:6},(n,s)=>{const o=new Date(d);return o.setDate(o.getDate()+s),o}),[d]),v=x[5];l.useEffect(()=>{(async()=>{b(!0);try{const s=localStorage.getItem("admin_token"),u=await(await fetch(`/api/admin/reservations?date_debut=${m(d)}&date_fin=${m(v)}&sort=date&order=asc&limit=100`,{headers:{Authorization:`Bearer ${s}`}})).json();c(u.reservations||[])}catch{console.error("Erreur chargement planning")}finally{b(!1)}})()},[r]);const _=l.useMemo(()=>{const n={};for(const s of i)n[s.date_rdv]||(n[s.date_rdv]=[]),n[s.date_rdv].push(s);return n},[i]),j=`${x[0].toLocaleDateString("fr-FR",{day:"numeric",month:"short"})} — ${v.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})}`;return e.jsxs(C,{children:[e.jsxs("div",{className:"p-4 md:p-6 planning-container",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6 planning-no-print",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-6 h-6 text-amber-400"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Planning"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>a(n=>n-1),className:"p-2 bg-zinc-800 rounded-lg hover:bg-zinc-700 transition text-white",children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>a(0),className:"px-4 py-2 bg-zinc-800 rounded-lg hover:bg-zinc-700 transition text-white text-sm font-medium",children:"Aujourd'hui"}),e.jsx("button",{onClick:()=>a(n=>n+1),className:"p-2 bg-zinc-800 rounded-lg hover:bg-zinc-700 transition text-white",children:e.jsx(E,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-white/60 text-sm ml-2 hidden sm:inline",children:j}),e.jsxs("button",{onClick:()=>window.print(),className:"ml-2 flex items-center gap-2 px-4 py-2 bg-amber-500 text-black rounded-lg hover:bg-amber-400 transition text-sm font-medium",children:[e.jsx(P,{className:"w-4 h-4"}),"Imprimer"]})]})]}),e.jsx("div",{className:"hidden planning-print-header",children:e.jsxs("h1",{className:"text-xl font-bold",children:["Planning — ",j]})}),h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"h-8 w-8 border-2 border-amber-500/30 border-t-amber-500 rounded-full animate-spin"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-[60px_repeat(6,1fr)] border-b border-zinc-700",children:[e.jsx("div",{className:"p-2"}),x.map((n,s)=>{const o=m(n)===m(new Date);return e.jsxs("div",{className:`p-3 text-center border-l border-zinc-700 ${o?"bg-amber-500/10":""}`,children:[e.jsx("div",{className:`text-sm font-medium ${o?"text-amber-400":"text-white/60"}`,children:I[s]}),e.jsx("div",{className:`text-lg font-bold ${o?"text-amber-400":"text-white"}`,children:T(n)})]},s)})]}),e.jsxs("div",{className:"grid grid-cols-[60px_repeat(6,1fr)]",children:[e.jsx("div",{className:"relative",children:k.map(n=>e.jsxs("div",{className:"h-16 flex items-start justify-end pr-2 pt-0.5 text-xs text-white/40 border-b border-zinc-800",children:[n,"h"]},n))}),x.map((n,s)=>{const o=m(n),u=_[o]||[],$=o===m(new Date);return e.jsxs("div",{className:`relative border-l border-zinc-700 ${$?"bg-amber-500/5":""}`,children:[k.map(t=>e.jsx("div",{className:"h-16 border-b border-zinc-800/50"},t)),u.map(t=>{const[z,S]=t.heure_rdv.split(":").map(Number),D=(z-f)*g+S/60*g,w=Math.max(t.service.duree_minutes/60*g,28),y=U(t.heure_rdv,t.service.duree_minutes),N=t.client?t.client.prenom:"Client",R=t.service.nom.length>18?t.service.nom.substring(0,16)+"…":t.service.nom,L=w<50;return e.jsx("div",{className:`absolute left-1 right-1 rounded-lg border-l-4 px-2 py-1 overflow-hidden cursor-default ${B(t.statut)}`,style:{top:`${D}px`,height:`${w}px`},title:`${t.client?.prenom} ${t.client?.nom} — ${t.service.nom}
${p(t.heure_rdv)} - ${p(y)}`,children:L?e.jsxs("p",{className:"text-xs font-medium truncate",children:[N," · ",p(t.heure_rdv)]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs font-semibold truncate",children:N}),e.jsx("p",{className:"text-[10px] opacity-80 truncate",children:R}),e.jsxs("p",{className:"text-[10px] opacity-60",children:[p(t.heure_rdv)," - ",p(y)]})]})},t.id)})]},s)})]})]})})]}),e.jsx("style",{children:`
        @media print {
          body * { visibility: hidden; }
          .planning-container, .planning-container * { visibility: visible; }
          .planning-container {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            background: white !important;
            color: black !important;
            padding: 16px !important;
          }
          .planning-no-print { display: none !important; }
          .planning-print-header { display: block !important; margin-bottom: 16px; }
          .planning-print-header h1 { color: black; }
          [class*="border-zinc"] { border-color: #ccc !important; }
          [class*="text-white"] { color: black !important; }
          [class*="text-amber"] { color: #b45309 !important; }
          [class*="bg-green"] { background: #dcfce7 !important; border-color: #16a34a !important; }
          [class*="bg-amber"][class*="border-amber"] { background: #fef3c7 !important; border-color: #d97706 !important; }
          [class*="bg-blue"] { background: #dbeafe !important; border-color: #2563eb !important; }
          [class*="bg-zinc"][class*="border-zinc-500"] { background: #e5e7eb !important; border-color: #6b7280 !important; }
          [class*="bg-red"] { background: #fee2e2 !important; border-color: #dc2626 !important; }
          [class*="text-green"], [class*="text-amber-3"], [class*="text-blue"], [class*="text-red"], [class*="text-zinc-4"] { color: black !important; }
          .overflow-x-auto { overflow: visible !important; }
          .min-w-\\[800px\\] { min-width: 0 !important; width: 100% !important; }
        }
      `})]})}export{ie as default};
