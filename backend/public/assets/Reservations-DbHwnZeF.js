import{a as Ee,r as l,j as e,B as p,t as Te,H as ee,X as L}from"./index-_yXYEqcL.js";import{A as Ae,C as te}from"./AdminLayout-CTeGiCEF.js";import{I as h}from"./input-TVuV-KxK.js";import{T as se}from"./textarea-C1wLWZvj.js";import{e as Fe}from"./exportCsv-B62shLnH.js";import{P as Re}from"./plus-D6ktc07k.js";import{F as $e}from"./filter-DLEMKo89.js";import{R as Ie}from"./rotate-ccw-CMY3EDTH.js";import{C as V}from"./clock-xh9IAeUk.js";import{U as ae}from"./user-Ai5-1aUm.js";import{B as re}from"./building-DNdEBFCU.js";import{S as ie}from"./square-pen-C-bOmknF.js";import{T as ne}from"./trash-2-CXbRkBbN.js";import{C as Be}from"./chevron-left-DzjsD1u5.js";import{C as Oe}from"./chevron-right-DPdOXaL5.js";import{M as Pe}from"./map-pin-lQiNTdD_.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./log-out-CvuSphzZ.js";const le={"Création crochet locks":"/gallery/creation-locks.jpg","Création microlocks crochet":"/gallery/creation-locks.jpg","Création microlocks twist":"/gallery/creation-locks.jpg","Reprise racines locks":"/gallery/entretien-locks.jpg","Reprise racines microlocks":"/gallery/entretien-locks.jpg","Décapage locks":"/gallery/entretien-locks.jpg","Création Locks":"/gallery/creation-locks.jpg",Microlocks:"/gallery/creation-locks.jpg","Entretien Locks":"/gallery/entretien-locks.jpg","Braids (Box braids)":"/gallery/braids-service.jpg","Box braids":"/gallery/braids-service.jpg","Braids / Box braids":"/gallery/braids-service.jpg","Nattes collées sans rajout":"/gallery/nattes-service.jpg","Nattes collées avec rajout":"/gallery/nattes-service.jpg","Nattes collées":"/gallery/nattes-service.jpg","Soin complet":"/gallery/soin-complet.jpg","Soin hydratant":"/gallery/soin-complet.jpg",Shampoing:"/gallery/soin-complet.jpg","Brushing afro":"/gallery/brushing-01.jpg","Brushing Afro":"/gallery/brushing-01.jpg","Teinture sans ammoniaque":"/gallery/coloration-naturelle.jpg","Coloration naturelle":"/gallery/coloration-naturelle.jpg",Décoloration:"/gallery/coloration-naturelle.jpg"},Me=d=>{if(!d)return"/gallery/creation-locks.jpg";if(le[d])return le[d];const x=d.toLowerCase();return x.includes("lock")?"/gallery/creation-locks.jpg":x.includes("braid")||x.includes("tresse")?"/gallery/braids-service.jpg":x.includes("natte")?"/gallery/nattes-service.jpg":x.includes("soin")?"/gallery/soin-complet.jpg":x.includes("brush")?"/gallery/brushing-01.jpg":x.includes("color")||x.includes("teint")?"/gallery/coloration-naturelle.jpg":"/gallery/creation-locks.jpg"},Le={en_attente:"bg-amber-500/20 text-amber-400 border border-amber-500/30",confirme:"bg-blue-500/20 text-blue-400 border border-blue-500/30",termine:"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30",annule:"bg-red-500/20 text-red-400 border border-red-500/30",no_show:"bg-white/10 text-white/50 border border-white/20"},oe={en_attente:"En attente",confirme:"Confirmé",termine:"Terminé",annule:"Annulé",no_show:"Absent"};function bt(){const{toast:d}=Ee(),[x,ce]=l.useState([]),[a,v]=l.useState({periode:"a_venir",statut:"tous",service:"",date_debut:"",date_fin:""}),[_,N]=l.useState(1),[E,de]=l.useState(1),[me,H]=l.useState(!0),[F,he]=l.useState({aujourd_hui:0,semaine:0,en_attente:0}),[xe,R]=l.useState(!1),[ue,k]=l.useState(!1),[pe,C]=l.useState(!1),[n,be]=l.useState(null),[g,U]=l.useState(null),[c,y]=l.useState({service_nom:"",date:"",heure:"",statut:"",notes:""}),[J,W]=l.useState(!1),[q,$]=l.useState(""),[Y,G]=l.useState([]),[I,ge]=l.useState([]),[we,B]=l.useState(""),[je,O]=l.useState(!1),[r,b]=l.useState({client_id:0,service:"",date_rdv:"",heure_rdv:"",lieu:"salon",adresse_client:"",distance_km:0,duree_trajet_minutes:0,frais_deplacement:0,notes:""}),[j,P]=l.useState(!1),[u,S]=l.useState({prenom:"",nom:"",telephone:"",email:""});l.useEffect(()=>{z(),D(),fe()},[a,_]);const z=async()=>{H(!0);try{const t=localStorage.getItem("admin_token"),s=new URLSearchParams({page:_.toString(),limit:"20",sort:"date",order:"desc"});if(a.statut!=="tous"&&s.append("statut",a.statut),a.service&&s.append("service",a.service),a.periode!=="tous")if(a.periode==="a_venir"){const i=new Date().toISOString().split("T")[0];s.append("date_debut",i)}else if(a.periode==="aujourd_hui"){const i=new Date().toISOString().split("T")[0];s.append("date_debut",i),s.append("date_fin",i)}else if(a.periode==="semaine"){const i=new Date,w=new Date(i);w.setDate(i.getDate()-i.getDay()+1);const f=new Date(w);f.setDate(w.getDate()+6),s.append("date_debut",w.toISOString().split("T")[0]),s.append("date_fin",f.toISOString().split("T")[0])}else if(a.periode==="mois"){const i=new Date,w=new Date(i.getFullYear(),i.getMonth(),1),f=new Date(i.getFullYear(),i.getMonth()+1,0);s.append("date_debut",w.toISOString().split("T")[0]),s.append("date_fin",f.toISOString().split("T")[0])}else a.periode==="personnalise"&&a.date_debut&&a.date_fin&&(s.append("date_debut",a.date_debut),s.append("date_fin",a.date_fin));const o=await fetch(`/api/admin/reservations?${s}`,{headers:{Authorization:`Bearer ${t}`}});if(!o.ok)throw new Error("Erreur lors du chargement des réservations");const m=await o.json();ce(m.reservations||[]),de(m.pagination?.pages||1)}catch(t){console.error("Erreur:",t),d({title:"Erreur",description:"Impossible de charger les réservations",variant:"destructive"})}finally{H(!1)}},D=async()=>{try{const t=localStorage.getItem("admin_token"),s=new Date().toISOString().split("T")[0],m=await(await fetch(`/api/admin/reservations?date_debut=${s}&date_fin=${s}`,{headers:{Authorization:`Bearer ${t}`}})).json(),i=new Date;i.setDate(i.getDate()-i.getDay()+1);const w=new Date(i);w.setDate(i.getDate()+6);const ze=await(await fetch(`/api/admin/reservations?date_debut=${i.toISOString().split("T")[0]}&date_fin=${w.toISOString().split("T")[0]}`,{headers:{Authorization:`Bearer ${t}`}})).json(),De=await(await fetch("/api/admin/reservations?statut=en_attente",{headers:{Authorization:`Bearer ${t}`}})).json();he({aujourd_hui:m.pagination?.total||0,semaine:ze.pagination?.total||0,en_attente:De.pagination?.total||0})}catch(t){console.error("Erreur stats:",t)}},fe=async()=>{try{const t=localStorage.getItem("admin_token"),o=await(await fetch("/api/admin/services",{headers:{Authorization:`Bearer ${t}`}})).json();ge(o.services||[])}catch(t){console.error("Erreur services:",t)}},ve=async t=>{if(!t||t.length<2){G([]);return}try{const s=localStorage.getItem("admin_token"),m=await(await fetch(`/api/admin/clients?search=${t}&limit=10`,{headers:{Authorization:`Bearer ${s}`}})).json();G(m.clients||[])}catch(s){console.error("Erreur recherche clients:",s)}},Ne=t=>{B(t),O(!0),ve(t)},ye=t=>{b({...r,client_id:t.id}),B(`${t.prenom} ${t.nom} - ${t.telephone}`),O(!1)},X=async t=>{try{const s=localStorage.getItem("admin_token"),m=await(await fetch(`/api/admin/reservations/${t.id}`,{headers:{Authorization:`Bearer ${s}`}})).json();be(m.reservation),R(!0)}catch(s){console.error("Erreur:",s),d({title:"Erreur",description:"Impossible de charger les détails",variant:"destructive"})}},K=async(t,s)=>{try{const o=localStorage.getItem("admin_token");if(!(await fetch(`/api/admin/reservations/${t}/statut`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({statut:s})})).ok)throw new Error("Erreur lors du changement de statut");d({title:"Succès",description:"Statut modifié"}),z(),D()}catch(o){console.error("Erreur:",o),d({title:"Erreur",description:"Impossible de modifier le statut",variant:"destructive"})}},Q=t=>{U(t),y({service_nom:t.service?.nom||"",date:t.date_rdv||"",heure:t.heure_rdv||"",statut:t.statut||"",notes:t.notes||""}),$(""),C(!0)},_e=async()=>{if(g){W(!0),$("");try{const t=localStorage.getItem("admin_token"),s=await fetch(`/api/admin/reservations/${g.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({service:c.service_nom,date_rdv:c.date,heure_rdv:c.heure,statut:c.statut,notes:c.notes})}),o=await s.json();if(!s.ok)throw new Error(o.error||o.message||"Erreur modification");d({title:"Succès",description:`RDV #${g.id} modifié`}),C(!1),U(null),z(),D()}catch(t){$(t.message||"Erreur")}finally{W(!1)}}},Z=async t=>{if(confirm(`Êtes-vous sûr de vouloir supprimer définitivement le RDV #${t} ?

Cette action est irréversible.`))try{const s=localStorage.getItem("admin_token"),o=await fetch(`/api/admin/reservations/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!o.ok){const m=await o.json();throw new Error(m.error||"Erreur lors de la suppression")}d({title:"Succès",description:`RDV #${t} supprimé`}),z(),D()}catch(s){d({title:"Erreur",description:s.message||"Impossible de supprimer la réservation",variant:"destructive"})}},ke=async()=>{const t=[];if(j?(u.prenom.trim()||t.push("Prénom du client"),u.nom.trim()||t.push("Nom du client"),u.telephone.trim()||t.push("Téléphone du client")):r.client_id||t.push("Client (cliquez sur un résultat de recherche)"),r.service||t.push("Service"),r.date_rdv||t.push("Date"),r.heure_rdv||t.push("Heure"),t.length>0){d({title:"Champs manquants",description:t.join(", "),variant:"destructive"});return}try{const s=localStorage.getItem("admin_token");let o=r.client_id;if(j){const i=await fetch("/api/admin/clients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(u)});if(!i.ok){const f=await i.json();throw new Error(f.error||"Erreur lors de la création du client")}o=(await i.json()).client.id}const m=await fetch("/api/admin/reservations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({...r,client_id:o})});if(!m.ok){const i=await m.json();throw new Error(i.error||"Erreur lors de la création")}d({title:"Succès",description:j?"Client et réservation créés":"Réservation créée"}),k(!1),T(),z(),D()}catch(s){console.error("Erreur:",s),d({title:"Erreur",description:s.message||"Impossible de créer la réservation",variant:"destructive"})}},T=()=>{b({client_id:0,service:"",date_rdv:"",heure_rdv:"",lieu:"salon",adresse_client:"",distance_km:0,duree_trajet_minutes:0,frais_deplacement:0,notes:""}),B(""),P(!1),S({prenom:"",nom:"",telephone:"",email:""})},Ce=()=>{const t=x.map(s=>({Date:A(s.date_rdv),Heure:s.heure_rdv,Client:s.client?`${s.client.prenom} ${s.client.nom}`:"Inconnu",Téléphone:s.client?.telephone||"",Service:s.service.nom,"Durée (min)":s.service.duree_minutes,Lieu:s.lieu==="salon"?"Chez Fatou":"Domicile",Adresse:s.adresse_client||"","Distance (km)":s.distance_km||"","Prix (€)":s.prix_total.toFixed(2),"Frais dépl. (€)":s.frais_deplacement.toFixed(2),Statut:oe[s.statut]||s.statut,Notes:s.notes||""}));Fe(t,"reservations")},Se=()=>{v({periode:"a_venir",statut:"tous",service:"",date_debut:"",date_fin:""}),N(1)},A=t=>new Date(t).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),M=t=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Le[t]||"bg-gray-100 text-gray-800"}`,children:oe[t]||t});return e.jsx(Ae,{children:e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl shadow-lg shadow-amber-500/30",children:e.jsx(te,{className:"w-6 h-6 text-white"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:"Réservations"})})]}),e.jsxs(p,{onClick:()=>k(!0),className:"w-full sm:w-auto bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white shadow-lg shadow-amber-500/30",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Nouvelle réservation"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl hover:border-amber-500/30 transition-all",children:[e.jsx("p",{className:"text-sm text-white/50 font-medium",children:"Aujourd'hui"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400 mt-1",children:F.aujourd_hui})]}),e.jsxs("div",{className:"p-4 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl hover:border-amber-500/30 transition-all",children:[e.jsx("p",{className:"text-sm text-white/50 font-medium",children:"Cette semaine"}),e.jsx("p",{className:"text-2xl font-bold text-violet-400 mt-1",children:F.semaine})]}),e.jsxs("div",{className:"p-4 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl hover:border-amber-500/30 transition-all",children:[e.jsx("p",{className:"text-sm text-white/50 font-medium",children:"En attente"}),e.jsx("p",{className:"text-2xl font-bold text-amber-400 mt-1",children:F.en_attente})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 p-3 md:p-4 rounded-xl space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"col-span-2 flex items-center gap-2 mb-1 sm:mb-0",children:[e.jsx($e,{className:"w-5 h-5 text-amber-400"}),e.jsx("span",{className:"text-sm text-white/50 sm:hidden",children:"Filtres"})]}),e.jsxs("select",{value:a.periode,onChange:t=>{v({...a,periode:t.target.value}),N(1)},className:"px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"tous",className:"bg-zinc-900",children:"Tous les RDV"}),e.jsx("option",{value:"a_venir",className:"bg-zinc-900",children:"À venir"}),e.jsx("option",{value:"aujourd_hui",className:"bg-zinc-900",children:"Aujourd'hui"}),e.jsx("option",{value:"semaine",className:"bg-zinc-900",children:"Cette semaine"}),e.jsx("option",{value:"mois",className:"bg-zinc-900",children:"Ce mois"}),e.jsx("option",{value:"personnalise",className:"bg-zinc-900",children:"Personnalisé"})]}),e.jsxs("select",{value:a.statut,onChange:t=>{v({...a,statut:t.target.value}),N(1)},className:"px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"tous",className:"bg-zinc-900",children:"Tous les statuts"}),e.jsx("option",{value:"en_attente",className:"bg-zinc-900",children:"En attente"}),e.jsx("option",{value:"confirme",className:"bg-zinc-900",children:"Confirmé"}),e.jsx("option",{value:"termine",className:"bg-zinc-900",children:"Terminé"}),e.jsx("option",{value:"annule",className:"bg-zinc-900",children:"Annulé"}),e.jsx("option",{value:"no_show",className:"bg-zinc-900",children:"Absent"})]}),e.jsx(h,{type:"text",placeholder:"Filtrer par service...",value:a.service,onChange:t=>{v({...a,service:t.target.value}),N(1)},className:"col-span-2 sm:w-64 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-amber-500/50"}),e.jsxs(p,{onClick:Se,variant:"outline",size:"sm",className:"border-white/20 text-white/70 hover:bg-white/10 hover:text-white",children:[e.jsx(Ie,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Reset"})]}),e.jsxs(p,{onClick:Ce,variant:"outline",size:"sm",className:"border-white/20 text-white/70 hover:bg-white/10 hover:text-white",children:[e.jsx(Te,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]})]}),a.periode==="personnalise"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{type:"date",value:a.date_debut,onChange:t=>v({...a,date_debut:t.target.value}),className:"w-48 bg-white/5 border-white/20 text-white focus:border-amber-500/50"}),e.jsx("span",{className:"flex items-center text-white/50",children:"à"}),e.jsx(h,{type:"date",value:a.date_fin,onChange:t=>v({...a,date_fin:t.target.value}),className:"w-48 bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]})]})]}),me?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"h-8 w-8 border-2 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-white/50",children:"Chargement..."})]}):x.length===0?e.jsxs("div",{className:"text-center py-12 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl",children:[e.jsx(te,{className:"w-16 h-16 text-white/20 mx-auto mb-4"}),e.jsx("p",{className:"text-white/50",children:"Aucune réservation trouvée"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{className:"bg-gradient-to-r from-amber-500/10 to-orange-500/10 border-b border-amber-500/20",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Date & Heure"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Service"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Lieu"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Prix"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-amber-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:x.map(t=>e.jsxs("tr",{onClick:()=>X(t),className:"hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-amber-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:A(t.date_rdv)}),e.jsx("div",{className:"text-sm text-white/50",children:t.heure_rdv})]})]})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:t.client?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-amber-400"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-white",children:[t.client.prenom," ",t.client.nom]}),e.jsx("div",{className:"text-sm text-white/50",children:t.client.telephone})]})]}):e.jsx("span",{className:"text-sm text-white/30",children:"Client inconnu"})}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("div",{className:"text-sm text-white",children:t.service.nom}),e.jsxs("div",{className:"text-xs text-white/50",children:[t.service.duree_minutes," min"]})]}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center gap-2",children:t.lieu==="salon"?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-sm text-white",children:"Chez Fatou"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-sm text-white",children:"Domicile"})]})})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-semibold text-emerald-400",children:[t.prix_total.toFixed(2)," €"]})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:M(t.statut)}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"flex gap-2 justify-end items-center",children:[e.jsx("button",{onClick:()=>Q(t),className:"p-1.5 rounded-lg hover:bg-white/10 text-amber-400 hover:text-amber-300 transition-colors",title:"Modifier",children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Z(t.id),className:"p-1.5 rounded-lg hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Supprimer",children:e.jsx(ne,{className:"w-4 h-4"})}),t.statut!=="termine"&&t.statut!=="annule"&&e.jsxs("select",{value:t.statut,onChange:s=>K(t.id,s.target.value),className:"px-2 py-1 text-xs bg-white/5 border border-white/20 text-white rounded focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"en_attente",className:"bg-zinc-900",children:"En attente"}),e.jsx("option",{value:"confirme",className:"bg-zinc-900",children:"Confirmé"}),e.jsx("option",{value:"termine",className:"bg-zinc-900",children:"Terminé"}),e.jsx("option",{value:"annule",className:"bg-zinc-900",children:"Annulé"}),e.jsx("option",{value:"no_show",className:"bg-zinc-900",children:"Absent"})]})]})})]},t.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:x.map(t=>e.jsxs("div",{onClick:()=>X(t),className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:bg-white/10 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-white font-medium",children:A(t.date_rdv)}),e.jsx("span",{className:"text-white/50",children:"à"}),e.jsx("span",{className:"text-white",children:t.heure_rdv})]}),M(t.statut)]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-white",children:t.client?`${t.client.prenom} ${t.client.nom}`:"Client inconnu"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.lieu==="salon"?e.jsx(re,{className:"w-4 h-4 text-amber-400"}):e.jsx(ee,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{className:"text-white/70 text-sm",children:t.service.nom})]}),e.jsxs("span",{className:"text-emerald-400 font-semibold",children:[t.prix_total.toFixed(2)," €"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap items-center gap-2",onClick:s=>s.stopPropagation(),children:[e.jsxs("button",{onClick:()=>Q(t),className:"px-3 py-2 text-sm bg-amber-500/10 border border-amber-500/30 text-amber-400 rounded-lg hover:bg-amber-500/20 transition-colors flex items-center gap-1",children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),"Modifier"]}),e.jsxs("button",{onClick:()=>Z(t.id),className:"px-3 py-2 text-sm bg-red-500/10 border border-red-500/30 text-red-400 rounded-lg hover:bg-red-500/20 transition-colors flex items-center gap-1",children:[e.jsx(ne,{className:"w-3.5 h-3.5"}),"Supprimer"]}),t.statut!=="termine"&&t.statut!=="annule"&&e.jsxs("select",{value:t.statut,onChange:s=>K(t.id,s.target.value),className:"w-full sm:w-auto mt-2 sm:mt-0 px-3 py-2 text-sm bg-white/5 border border-white/20 text-white rounded-lg focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"en_attente",className:"bg-zinc-900",children:"En attente"}),e.jsx("option",{value:"confirme",className:"bg-zinc-900",children:"Confirmé"}),e.jsx("option",{value:"termine",className:"bg-zinc-900",children:"Terminé"}),e.jsx("option",{value:"annule",className:"bg-zinc-900",children:"Annulé"}),e.jsx("option",{value:"no_show",className:"bg-zinc-900",children:"Absent"})]})]})]},t.id))}),E>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-white/50",children:["Page ",_," sur ",E]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{onClick:()=>N(t=>Math.max(1,t-1)),disabled:_===1,variant:"outline",size:"sm",className:"border-white/20 text-white/70 hover:bg-white/10 hover:text-white disabled:opacity-30",children:[e.jsx(Be,{className:"w-4 h-4 mr-1"}),"Précédent"]}),e.jsxs(p,{onClick:()=>N(t=>Math.min(E,t+1)),disabled:_===E,variant:"outline",size:"sm",className:"border-white/20 text-white/70 hover:bg-white/10 hover:text-white disabled:opacity-30",children:["Suivant",e.jsx(Oe,{className:"w-4 h-4 ml-1"})]})]})]})]}),pe&&g&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>C(!1),children:e.jsxs("div",{className:"bg-zinc-900 border border-amber-500/30 rounded-2xl shadow-2xl w-full max-w-md",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-5 py-3 border-b border-amber-500/20 flex items-center justify-between bg-gradient-to-r from-amber-500/10 to-orange-500/10 rounded-t-2xl",children:[e.jsxs("h2",{className:"text-lg font-bold text-white",children:["Modifier RDV #",g.id]}),e.jsx(p,{onClick:()=>C(!1),variant:"ghost",size:"sm",className:"text-white/70 hover:text-white hover:bg-white/10 h-8 w-8 p-0",children:e.jsx(L,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-5 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsx("div",{className:"p-3 bg-white/5 border border-white/10 rounded-xl",children:e.jsx("p",{className:"text-sm text-white/70",children:g.client?`${g.client.prenom} ${g.client.nom} — ${g.client.telephone}`:"Client inconnu"})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70 mb-1 block",children:"Service"}),e.jsx("select",{value:c.service_nom,onChange:t=>y({...c,service_nom:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 text-white rounded-lg focus:border-amber-500/50 focus:outline-none",children:I.filter(t=>t.actif!==!1).map(t=>e.jsxs("option",{value:t.nom,className:"bg-zinc-900",children:[t.nom," — ",(t.prix/100).toFixed(0),"€ (",t.duree_minutes,"min)"]},t.id))}),c.service_nom!==(g.service?.nom||"")&&(()=>{const t=I.find(s=>s.nom===c.service_nom);return t?e.jsxs("div",{className:"mt-2 p-2 bg-blue-500/10 border border-blue-500/20 rounded-lg text-sm text-blue-300",children:["Nouveau prix : ",(t.prix/100).toFixed(0),"€ — Durée : ",t.duree_minutes,"min"]}):null})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70 mb-1 block",children:"Date"}),e.jsx("input",{type:"date",value:c.date,onChange:t=>y({...c,date:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 text-white rounded-lg focus:border-amber-500/50 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70 mb-1 block",children:"Heure"}),e.jsx("input",{type:"time",value:c.heure,onChange:t=>y({...c,heure:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 text-white rounded-lg focus:border-amber-500/50 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70 mb-1 block",children:"Statut"}),e.jsxs("select",{value:c.statut,onChange:t=>y({...c,statut:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 text-white rounded-lg focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"demande",className:"bg-zinc-900",children:"En attente"}),e.jsx("option",{value:"en_attente",className:"bg-zinc-900",children:"En attente confirmation"}),e.jsx("option",{value:"confirme",className:"bg-zinc-900",children:"Confirmé"}),e.jsx("option",{value:"termine",className:"bg-zinc-900",children:"Terminé"}),e.jsx("option",{value:"annule",className:"bg-zinc-900",children:"Annulé"}),e.jsx("option",{value:"no_show",className:"bg-zinc-900",children:"Absent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70 mb-1 block",children:"Notes"}),e.jsx(se,{value:c.notes,onChange:t=>y({...c,notes:t.target.value}),rows:2,className:"bg-white/5 border-white/20 text-white"})]}),q&&e.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:q}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(p,{onClick:()=>C(!1),variant:"outline",className:"flex-1 border-white/20 text-white/70 hover:bg-white/10",children:"Annuler"}),e.jsx(p,{onClick:_e,disabled:J,className:"flex-1 bg-gradient-to-r from-amber-500 to-orange-600 text-white hover:from-amber-600 hover:to-orange-700",children:J?"Sauvegarde...":"Enregistrer"})]})]})]})}),xe&&n&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:e.jsxs("div",{className:"bg-zinc-900 border border-amber-500/30 rounded-2xl shadow-2xl w-full max-w-md ml-24",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-5 py-3 border-b border-amber-500/20 flex items-center justify-between bg-gradient-to-r from-amber-500/10 to-orange-500/10 rounded-t-2xl",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Détails RDV"}),e.jsx(p,{onClick:()=>R(!1),variant:"ghost",size:"sm",className:"text-white/70 hover:text-white hover:bg-white/10 h-8 w-8 p-0",children:e.jsx(L,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"p-5 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{className:"relative w-full h-40 rounded-xl overflow-hidden",children:[e.jsx("img",{src:Me(n.service.nom),alt:n.service.nom,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute bottom-2 left-3 right-3",children:e.jsx("p",{className:"text-white font-semibold text-lg drop-shadow-lg",children:n.service.nom})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-amber-400"}),e.jsxs("span",{className:"text-white font-medium",children:[A(n.date_rdv)," à ",n.heure_rdv]})]}),M(n.statut)]}),n.client&&e.jsx("div",{className:"p-3 bg-white/5 border border-white/10 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-600 rounded-full flex items-center justify-center text-white font-bold",children:n.client.prenom?.[0]||n.client.nom?.[0]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-white",children:[n.client.prenom," ",n.client.nom]}),e.jsx("p",{className:"text-sm text-white/50",children:n.client.telephone})]})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:n.service.nom}),e.jsxs("p",{className:"text-xs text-white/50",children:[n.service.duree_minutes," min"]})]}),e.jsxs("span",{className:"text-xl font-bold text-emerald-400",children:[n.prix_total.toFixed(2)," €"]})]}),e.jsxs("div",{className:"p-3 bg-white/5 border border-white/10 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Pe,{className:"w-4 h-4 text-amber-400"}),e.jsx("span",{className:"text-sm text-white/50",children:"Lieu"})]}),n.lieu==="salon"?e.jsx("p",{className:"text-white/80 text-sm",children:"Chez Fatou - Franconville"}):e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:"Domicile"}),n.adresse_client&&e.jsx("p",{className:"text-xs text-white/50 mt-1",children:n.adresse_client})]})]}),n.frais_deplacement>0&&e.jsxs("p",{className:"text-xs text-white/40 text-center",children:["Dont ",n.frais_deplacement.toFixed(2)," € de frais de déplacement"]}),n.notes&&e.jsxs("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-xl",children:[e.jsx("p",{className:"text-xs text-yellow-400 mb-1",children:"Notes"}),e.jsx("p",{className:"text-white/80 text-sm",children:n.notes})]}),e.jsxs("p",{className:"text-xs text-white/30 text-center",children:["Créée via ",n.created_via||"chatbot"]})]})]})}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>{k(!1),T()},children:e.jsxs("div",{className:"bg-zinc-900 border border-amber-500/20 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[85vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-amber-500/20 flex items-center justify-between bg-gradient-to-r from-amber-500/10 to-orange-500/10",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Nouvelle réservation"}),e.jsx(p,{onClick:()=>{k(!1),T()},variant:"ghost",size:"sm",className:"text-white/70 hover:text-white hover:bg-white/10",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition ${j?"bg-white/5 text-white/50 border border-white/10 hover:bg-white/10":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:"Client existant"}),e.jsx("button",{type:"button",onClick:()=>P(!0),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition ${j?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-white/50 border border-white/10 hover:bg-white/10"}`,children:"+ Nouveau client"})]}),!j&&e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Rechercher un client *"}),e.jsx(h,{type:"text",placeholder:"Nom, prénom ou téléphone...",value:we,onChange:t=>Ne(t.target.value),onFocus:()=>O(!0),className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-amber-500/50"}),je&&Y.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-zinc-800 border border-amber-500/20 rounded-xl shadow-lg max-h-48 overflow-y-auto",children:Y.map(t=>e.jsxs("button",{onClick:()=>ye(t),className:"w-full px-4 py-2 text-left hover:bg-white/10 border-b border-white/5 last:border-0",children:[e.jsxs("p",{className:"font-medium text-white",children:[t.prenom," ",t.nom]}),e.jsx("p",{className:"text-sm text-white/50",children:t.telephone})]},t.id))})]}),j&&e.jsxs("div",{className:"space-y-3 p-3 bg-emerald-500/5 border border-emerald-500/20 rounded-xl",children:[e.jsx("p",{className:"text-xs text-emerald-400 font-medium",children:"Nouveau client"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-white/70 mb-1",children:"Prénom *"}),e.jsx(h,{type:"text",placeholder:"Marie",value:u.prenom,onChange:t=>S({...u,prenom:t.target.value}),className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-emerald-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-white/70 mb-1",children:"Nom *"}),e.jsx(h,{type:"text",placeholder:"Dupont",value:u.nom,onChange:t=>S({...u,nom:t.target.value}),className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-emerald-500/50"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-white/70 mb-1",children:"Téléphone *"}),e.jsx(h,{type:"tel",placeholder:"06 12 34 56 78",value:u.telephone,onChange:t=>S({...u,telephone:t.target.value}),className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-emerald-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-white/70 mb-1",children:"Email"}),e.jsx(h,{type:"email",placeholder:"email@exemple.fr",value:u.email,onChange:t=>S({...u,email:t.target.value}),className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-emerald-500/50"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Service *"}),e.jsxs("select",{value:r.service,onChange:t=>b({...r,service:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",className:"bg-zinc-900",children:"Sélectionner un service"}),I.filter(t=>t.actif!==!1).map(t=>e.jsxs("option",{value:t.nom,className:"bg-zinc-900",children:[t.nom," - ",(t.prix/100).toFixed(2),"€ - ",t.duree_minutes,"min"]},t.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Date *"}),e.jsx(h,{type:"date",value:r.date_rdv,onChange:t=>b({...r,date_rdv:t.target.value}),className:"bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Heure *"}),e.jsx(h,{type:"time",value:r.heure_rdv,onChange:t=>b({...r,heure_rdv:t.target.value}),className:"bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Lieu *"}),e.jsxs("select",{value:r.lieu,onChange:t=>b({...r,lieu:t.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-white/20 rounded-lg text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"salon",className:"bg-zinc-900",children:"Chez Fatou"}),e.jsx("option",{value:"domicile",className:"bg-zinc-900",children:"Domicile du client"})]})]}),r.lieu==="domicile"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Adresse du client"}),e.jsx(h,{type:"text",value:r.adresse_client,onChange:t=>b({...r,adresse_client:t.target.value}),placeholder:"15 rue Victor Hugo, 95100 Argenteuil",className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-amber-500/50"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Distance (km)"}),e.jsx(h,{type:"number",step:"0.1",value:r.distance_km,onChange:t=>b({...r,distance_km:parseFloat(t.target.value)||0}),className:"bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Durée trajet (min)"}),e.jsx(h,{type:"number",value:r.duree_trajet_minutes,onChange:t=>b({...r,duree_trajet_minutes:parseInt(t.target.value)||0}),className:"bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Frais dépl. (€)"}),e.jsx(h,{type:"number",step:"0.01",value:r.frais_deplacement,onChange:t=>b({...r,frais_deplacement:parseFloat(t.target.value)||0}),className:"bg-white/5 border-white/20 text-white focus:border-amber-500/50"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white/70 mb-1",children:"Notes"}),e.jsx(se,{value:r.notes,onChange:t=>b({...r,notes:t.target.value}),rows:3,placeholder:"Notes additionnelles...",className:"bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-amber-500/50"})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-amber-500/20 flex justify-end gap-2",children:[e.jsx(p,{onClick:()=>{k(!1),T()},variant:"outline",className:"border-white/20 text-white/70 hover:bg-white/10 hover:text-white",children:"Annuler"}),e.jsx(p,{onClick:ke,className:"bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white",children:"Créer la réservation"})]})]})})]})})}export{bt as default};
