import{r,j as e,X as d}from"./index-_yXYEqcL.js";import{A as v}from"./AdminLayout-CTeGiCEF.js";import{M as N}from"./message-square-BHRNNhOm.js";import{C as x}from"./check-B1pij6wq.js";import{S as y}from"./star-nlKRpWv2.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./user-Ai5-1aUm.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";function F(){const[i,p]=r.useState([]),[s,h]=r.useState("pending"),[g,c]=r.useState(!0),[o,u]=r.useState(0),l=async()=>{c(!0);try{const t=localStorage.getItem("admin_token"),n=await(await fetch(`/api/reviews/admin?status=${s}&limit=50`,{headers:{Authorization:`Bearer ${t}`}})).json();p(n.reviews||[]),u(n.pendingCount||0)}catch{console.error("Erreur chargement avis")}finally{c(!1)}};r.useEffect(()=>{l()},[s]);const m=async(t,a)=>{try{const n=localStorage.getItem("admin_token");(await fetch(`/api/reviews/admin/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({status:a})})).ok&&l()}catch{console.error("Erreur action avis")}},j=t=>new Date(t).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),b=t=>e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(a=>e.jsx(y,{className:`w-4 h-4 ${a<=t?"fill-amber-400 text-amber-400":"text-zinc-600"}`},a))}),f=[{key:"pending",label:`En attente${o>0?` (${o})`:""}`},{key:"approved",label:"Approuvés"},{key:"rejected",label:"Rejetés"}];return e.jsx(v,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(N,{className:"w-6 h-6 text-amber-400"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Avis Clients"})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:f.map(t=>e.jsx("button",{onClick:()=>h(t.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${s===t.key?"bg-amber-500 text-black":"bg-zinc-800 text-zinc-400 hover:text-white"}`,children:t.label},t.key))}),g?e.jsx("div",{className:"text-center py-12 text-zinc-400",children:"Chargement..."}):i.length===0?e.jsxs("div",{className:"text-center py-12 text-zinc-500",children:[s==="pending"&&"Aucun avis en attente de modération",s==="approved"&&"Aucun avis approuvé",s==="rejected"&&"Aucun avis rejeté"]}):e.jsx("div",{className:"space-y-4",children:i.map(t=>e.jsx("div",{className:"bg-zinc-900 border border-zinc-800 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"font-semibold text-white",children:t.client_prenom}),b(t.rating),e.jsx("span",{className:"text-xs text-zinc-500",children:j(t.created_at)})]}),t.comment&&e.jsx("p",{className:"text-zinc-300 text-sm",children:t.comment})]}),s==="pending"&&e.jsxs("div",{className:"flex gap-2 ml-4 shrink-0",children:[e.jsxs("button",{onClick:()=>m(t.id,"approved"),className:"flex items-center gap-1 px-3 py-1.5 bg-green-900/30 text-green-400 border border-green-800 rounded-lg text-sm hover:bg-green-900/50 transition",children:[e.jsx(x,{className:"w-4 h-4"}),"Approuver"]}),e.jsxs("button",{onClick:()=>m(t.id,"rejected"),className:"flex items-center gap-1 px-3 py-1.5 bg-red-900/30 text-red-400 border border-red-800 rounded-lg text-sm hover:bg-red-900/50 transition",children:[e.jsx(d,{className:"w-4 h-4"}),"Rejeter"]})]}),s==="approved"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-400 text-xs ml-4",children:[e.jsx(x,{className:"w-3 h-3"}),"Publié"]}),s==="rejected"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-400 text-xs ml-4",children:[e.jsx(d,{className:"w-3 h-3"}),"Rejeté"]})]})},t.id))})]})})}export{F as default};
