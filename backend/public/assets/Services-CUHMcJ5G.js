import{c as S,r as i,j as e}from"./index-_yXYEqcL.js";import{A as N}from"./AdminLayout-CTeGiCEF.js";import{P as k}from"./plus-D6ktc07k.js";import{a as _}from"./settings-BkyowQvs.js";import{E as C}from"./euro-BOxFFLgt.js";import{C as T}from"./clock-xh9IAeUk.js";import{P as E}from"./percent-B3SZmwXD.js";import{S as A}from"./square-pen-C-bOmknF.js";import{T as z}from"./trash-2-CXbRkBbN.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./user-Ai5-1aUm.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=S("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);function re(){const[a,g]=i.useState([]),[h,r]=i.useState(!0),[o,n]=i.useState(!1),[m,u]=i.useState(null),[l,f]=i.useState("");i.useEffect(()=>{s()},[]);const s=async()=>{try{const t=localStorage.getItem("admin_token"),x=await(await fetch("/api/admin/services",{headers:{Authorization:`Bearer ${t}`}})).json();g(x.services)}catch(t){console.error("Erreur chargement services:",t)}finally{r(!1)}},d=async t=>{try{const c=localStorage.getItem("admin_token");await fetch(`/api/admin/services/${t}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${c}`}}),s()}catch(c){console.error("Erreur toggle:",c)}},b=async(t,c)=>{if(confirm(`Supprimer le service "${c}" ?`))try{const x=localStorage.getItem("admin_token"),v=await fetch(`/api/admin/services/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${x}`}});if(!v.ok){const w=await v.json();alert(w.error);return}s()}catch(x){console.error("Erreur suppression:",x)}},j=t=>{u(t),n(!0)},y=()=>{u(null),n(!0)},p=a.filter(t=>t.nom.toLowerCase().includes(l.toLowerCase()));return h?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-gray-500",children:"Chargement..."})})}):e.jsxs(N,{children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Services"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez vos prestations et tarifs"})]}),e.jsxs("button",{onClick:y,className:"flex items-center gap-2 bg-gradient-to-r from-purple-600 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 transition",children:[e.jsx(k,{size:20}),"Nouveau service"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Rechercher un service...",value:l,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(t=>e.jsxs("div",{className:`
                bg-white rounded-xl shadow-sm p-6 border-2 transition
                ${t.actif?"border-transparent hover:border-purple-200":"border-gray-200 opacity-60"}
              `,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:t.nom}),t.categorie&&e.jsx("span",{className:"inline-block mt-1 px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full",children:t.categorie})]}),e.jsx("button",{onClick:()=>d(t.id),className:`
                    p-2 rounded-lg transition
                    ${t.actif?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-400 hover:bg-gray-200"}
                  `,children:e.jsx(F,{size:18})})]}),t.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(C,{size:16,className:"text-purple-600"}),e.jsxs("span",{className:"font-semibold",children:[(t.prix/100).toFixed(2),"€ TTC"]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",((t.prix_ht||t.prix)/100).toFixed(2),"€ HT)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(T,{size:16,className:"text-purple-600"}),e.jsxs("span",{children:[Math.floor(t.duree_minutes/60),"h",t.duree_minutes%60>0?` ${t.duree_minutes%60}min`:""]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx(E,{size:16,className:"text-purple-600"}),e.jsxs("span",{children:["TVA ",t.taux_tva||20,"%"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs("button",{onClick:()=>j(t),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 transition",children:[e.jsx(A,{size:16}),"Modifier"]}),e.jsx("button",{onClick:()=>b(t.id,t.nom),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition",children:e.jsx(z,{size:16})})]})]},t.id))}),p.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:l?"Aucun service trouvé":"Aucun service pour le moment"})]}),o&&e.jsx(M,{service:m,onClose:()=>n(!1),onSave:()=>{n(!1),s()}})]})}function M({service:a,onClose:g,onSave:h}){const[r,o]=i.useState({nom:a?.nom||"",description:a?.description||"",prix:a?(a.prix/100).toString():"",duree_heures:a?Math.floor(a.duree_minutes/60).toString():"0",duree_minutes:a?(a.duree_minutes%60).toString():"0",categorie:a?.categorie||"Coiffure",actif:a?.actif!==!1,taux_tva:a?.taux_tva?.toString()||"20"}),[n,m]=i.useState(!1),[u,l]=i.useState(""),f=async s=>{s.preventDefault(),l(""),m(!0);try{const d=parseInt(r.duree_heures)*60+parseInt(r.duree_minutes);if(!r.nom||!r.prix||d===0)throw new Error("Veuillez remplir tous les champs obligatoires");const b=localStorage.getItem("admin_token"),j=a?`/api/admin/services/${a.id}`:"/api/admin/services",p=await fetch(j,{method:a?"PUT":"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({nom:r.nom,description:r.description,prix:parseFloat(r.prix),duree_minutes:d,categorie:r.categorie,actif:r.actif,taux_tva:parseFloat(r.taux_tva)})});if(!p.ok){const t=await p.json();throw new Error(t.error||"Erreur serveur")}h()}catch(d){l(d.message)}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Modifier le service":"Nouveau service"})}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-6",children:[u&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:u}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du service *"}),e.jsx("input",{type:"text",value:r.nom,onChange:s=>o({...r,nom:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: Tresses classiques",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:s=>o({...r,description:s.target.value}),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Description du service..."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix TTC (€) *"}),e.jsx("input",{type:"number",step:"0.01",value:r.prix,onChange:s=>o({...r,prix:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"80.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taux TVA *"}),e.jsxs("select",{value:r.taux_tva,onChange:s=>o({...r,taux_tva:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"20",children:"20% (normal)"}),e.jsx("option",{value:"10",children:"10% (intermédiaire)"}),e.jsx("option",{value:"5.5",children:"5.5% (réduit)"}),e.jsx("option",{value:"2.1",children:"2.1% (super-réduit)"}),e.jsx("option",{value:"0",children:"0% (exonéré)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie"}),e.jsxs("select",{value:r.categorie,onChange:s=>o({...r,categorie:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{children:"Coiffure"}),e.jsx("option",{children:"Tresses"}),e.jsx("option",{children:"Soins"}),e.jsx("option",{children:"Autre"})]})]})]}),r.prix&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Prix HT:"}),e.jsxs("span",{className:"font-medium",children:[(parseFloat(r.prix)/(1+parseFloat(r.taux_tva)/100)).toFixed(2),"€"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsxs("span",{children:["TVA (",r.taux_tva,"%):"]}),e.jsxs("span",{className:"font-medium",children:[(parseFloat(r.prix)-parseFloat(r.prix)/(1+parseFloat(r.taux_tva)/100)).toFixed(2),"€"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Durée *"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",min:"0",max:"8",value:r.duree_heures,onChange:s=>o({...r,duree_heures:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Heures"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Heures"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",min:"0",max:"59",step:"15",value:r.duree_minutes,onChange:s=>o({...r,duree_minutes:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Minutes"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minutes"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"actif",checked:r.actif,onChange:s=>o({...r,actif:s.target.checked}),className:"w-5 h-5 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),e.jsx("label",{htmlFor:"actif",className:"text-sm font-medium text-gray-700",children:"Service actif (visible pour les clients)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:g,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:n,className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-500 text-white rounded-lg font-semibold hover:from-purple-700 hover:to-pink-600 transition disabled:opacity-50",children:n?"Enregistrement...":a?"Modifier":"Créer"})]})]})]})})}export{re as default};
