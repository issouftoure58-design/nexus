import{c as f,r,a as z,j as e,C as P,S as d,X as S,L as A}from"./index-_yXYEqcL.js";import{A as I}from"./AdminLayout-CTeGiCEF.js";import{P as L}from"./plus-D6ktc07k.js";import{F as $,I as _}from"./instagram-HBzeWPol.js";import{C as g}from"./circle-check-big-BOhRDXR_.js";import{C as E}from"./clock-xh9IAeUk.js";import{C as U}from"./calendar-NWhThMGY.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./user-Ai5-1aUm.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=f("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=f("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),m=[{id:"facebook",name:"Facebook",icon:$,color:"from-blue-500 to-blue-600",bg:"bg-blue-500/10",text:"text-blue-400"},{id:"instagram",name:"Instagram",icon:_,color:"from-pink-500 to-purple-600",bg:"bg-pink-500/10",text:"text-pink-400"},{id:"linkedin",name:"LinkedIn",icon:R,color:"from-blue-600 to-blue-700",bg:"bg-blue-600/10",text:"text-blue-300"}];function ie(){const[x,w]=r.useState([]),[n,j]=r.useState([]),[N,o]=r.useState(!1),[h,u]=r.useState(!1),{toast:l}=z(),[i,c]=r.useState({platform:"facebook",content:"",imageUrl:"",caption:"",scheduledAt:""});r.useEffect(()=>{v(),b()},[]);async function v(){try{const t=localStorage.getItem("admin_token"),a=await(await fetch("/api/admin/social/accounts",{headers:{Authorization:`Bearer ${t}`}})).json();a.success&&w(a.accounts||[])}catch{}}async function b(){try{const t=localStorage.getItem("admin_token"),a=await(await fetch("/api/admin/media/history?limit=30",{headers:{Authorization:`Bearer ${t}`}})).json();a.success&&j(a.history||[])}catch{}}function y(t){t==="facebook"||t==="instagram"?window.location.href="/auth/facebook":l({title:"Info",description:`${t} OAuth bientot disponible`})}async function k(){if(!i.content&&!i.imageUrl){l({title:"Erreur",description:"Contenu ou image requis",variant:"destructive"});return}u(!0);try{const t=localStorage.getItem("admin_token"),a=await(await fetch("/api/admin/social/publish",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({platform:i.platform,message:i.content,caption:i.caption||i.content,imageUrl:i.imageUrl})})).json();a.success?(l({title:"Publie !",description:`Post publie sur ${i.platform}`}),o(!1),c({platform:"facebook",content:"",imageUrl:"",caption:"",scheduledAt:""}),b()):l({title:"Erreur",description:a.error,variant:"destructive"})}catch{l({title:"Erreur",description:"Echec publication",variant:"destructive"})}finally{u(!1)}}const p=t=>x.some(s=>s.platform===t&&s.status==="active");return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Reseaux Sociaux"}),e.jsx("p",{className:"text-white/50",children:"Gerez vos comptes et publications"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold rounded-xl shadow-lg shadow-amber-500/30 hover:shadow-amber-500/50 transition-all",children:[e.jsx(L,{size:18}),"Nouvelle publication"]})]}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Comptes connectes"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:m.map(t=>{const s=t.icon,a=p(t.id);return e.jsxs("div",{className:"p-4 bg-white/5 border border-white/10 rounded-xl flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl ${t.bg} flex items-center justify-center`,children:e.jsx(s,{size:20,className:t.text})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:t.name}),a?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-green-400",children:[e.jsx(g,{size:12}),"Connecte"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-white/40",children:[e.jsx(F,{size:12}),"Non connecte"]})]})]}),!a&&e.jsx("button",{onClick:()=>y(t.id),className:`px-3 py-1.5 bg-gradient-to-r ${t.color} text-white text-sm rounded-lg hover:shadow-lg transition-all`,children:"Connecter"})]},t.id)})})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Publications",value:n.filter(t=>t.status==="published").length,icon:g,color:"text-green-400"},{label:"Programmees",value:n.filter(t=>t.status==="scheduled").length,icon:E,color:"text-blue-400"},{label:"Brouillons",value:n.filter(t=>t.status==="draft").length,icon:U,color:"text-amber-400"},{label:"Erreurs",value:n.filter(t=>t.status==="error").length,icon:P,color:"text-red-400"}].map(t=>{const s=t.icon;return e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur-xl border border-white/10 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(s,{size:16,className:t.color}),e.jsx("span",{className:"text-xs text-white/50",children:t.label})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.value})]},t.label)})}),e.jsxs("div",{className:"bg-zinc-900/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Publications recentes"}),n.length===0?e.jsxs("div",{className:"text-center py-12 text-white/30",children:[e.jsx(d,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Aucune publication pour le moment"}),e.jsx("p",{className:"text-sm mt-1",children:"Connectez vos comptes et commencez a publier"})]}):e.jsx("div",{className:"space-y-3",children:n.slice(0,10).map(t=>{const s=m.find(C=>C.id===t.platform),a=s?.icon||d;return e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white/5 rounded-xl border border-white/5",children:[t.image_url&&e.jsx("img",{src:t.image_url,alt:"",className:"w-16 h-16 rounded-lg object-cover flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(a,{size:14,className:s?.text||"text-white/60"}),e.jsx("span",{className:"text-xs text-white/60",children:s?.name||t.platform}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.status==="published"?"bg-green-500/10 text-green-400":t.status==="scheduled"?"bg-blue-500/10 text-blue-400":t.status==="error"?"bg-red-500/10 text-red-400":"bg-white/10 text-white/50"}`,children:t.status})]}),e.jsx("p",{className:"text-sm text-white/80 line-clamp-2",children:t.content}),e.jsx("p",{className:"text-xs text-white/30 mt-1",children:t.published_at?new Date(t.published_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}):t.scheduled_at?`Programme: ${new Date(t.scheduled_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}`:new Date(t.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long"})})]})]},t.id)})})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-zinc-900 border border-white/10 rounded-2xl w-full max-w-lg p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Nouvelle publication"}),e.jsx("button",{onClick:()=>o(!1),className:"text-white/50 hover:text-white",children:e.jsx(S,{size:20})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-white/60 mb-1.5 block",children:"Plateforme"}),e.jsxs("div",{className:"flex gap-2",children:[m.filter(t=>p(t.id)).map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>c({...i,platform:t.id}),className:`flex items-center gap-2 px-3 py-2 rounded-xl text-sm transition-all ${i.platform===t.id?`bg-gradient-to-r ${t.color} text-white`:"bg-white/5 border border-white/10 text-white/60"}`,children:[e.jsx(s,{size:16}),t.name]},t.id)}),x.length===0&&e.jsx("p",{className:"text-sm text-white/40",children:"Aucun compte connecte. Connectez un compte d'abord."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-white/60 mb-1.5 block",children:"Contenu"}),e.jsx("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2.5 text-white placeholder-white/30 focus:border-amber-500/50 focus:outline-none resize-none",rows:4,placeholder:"Votre message...",value:i.content,onChange:t=>c({...i,content:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-white/60 mb-1.5 block",children:"URL Image (optionnel)"}),e.jsx("input",{type:"text",className:"w-full bg-white/5 border border-white/10 rounded-xl px-3 py-2.5 text-white placeholder-white/30 focus:border-amber-500/50 focus:outline-none",placeholder:"https://...",value:i.imageUrl,onChange:t=>c({...i,imageUrl:t.target.value})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>o(!1),className:"flex-1 px-4 py-2.5 bg-white/5 border border-white/10 text-white/70 rounded-xl hover:bg-white/10 transition-all",children:"Annuler"}),e.jsxs("button",{onClick:k,disabled:h,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-semibold rounded-xl shadow-lg shadow-amber-500/30 transition-all disabled:opacity-50",children:[h?e.jsx(A,{size:16,className:"animate-spin"}):e.jsx(d,{size:16}),"Publier maintenant"]})]})]})})]})})}export{ie as default};
