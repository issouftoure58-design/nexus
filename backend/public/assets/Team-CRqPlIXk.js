import{r as h,j as e}from"./index-_yXYEqcL.js";import{A as w}from"./AdminLayout-CTeGiCEF.js";import"./file-text-DGGLtmm2.js";import"./image-nfPd-l1I.js";import"./settings-BkyowQvs.js";import"./user-Ai5-1aUm.js";import"./calendar-NWhThMGY.js";import"./scissors-DPHsfmq1.js";import"./users-DLPfMp13.js";import"./shopping-bag-CEo4UOGG.js";import"./message-square-BHRNNhOm.js";import"./sparkles-BX8nnFHk.js";import"./chart-column-eauyrf0D.js";import"./chevron-right-DPdOXaL5.js";import"./log-out-CvuSphzZ.js";const f=()=>({Authorization:`Bearer ${localStorage.getItem("admin_token")}`,"Content-Type":"application/json"});function $(){const[t,l]=h.useState([]),[r,n]=h.useState(!0),[m,o]=h.useState(null),p=async()=>{try{const s=await(await fetch("/api/admin/agents",{headers:f()})).json();s.success&&l(s.agents)}catch(a){console.error("Error fetching agents:",a)}finally{n(!1)}};h.useEffect(()=>{p()},[]);const c=async(a,s)=>{try{(await(await fetch(`/api/admin/agents/${a}`,{method:"PATCH",headers:f(),body:JSON.stringify(s)})).json()).success&&(await p(),o(null))}catch(i){console.error("Error updating agent:",i)}},x=t.find(a=>a.agent_type==="reception"),u=t.find(a=>a.agent_type==="backoffice");return e.jsxs(w,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Votre Equipe IA"}),e.jsx("p",{className:"text-sm text-white/50 mt-1",children:"Configurez vos agents intelligents personnalises"})]}),r?e.jsx("div",{className:"space-y-4",children:[1,2].map(a=>e.jsx("div",{className:"h-48 bg-zinc-900 rounded-xl animate-pulse"},a))}):e.jsxs("div",{className:"space-y-4",children:[x&&e.jsx(j,{agent:x,onEdit:()=>o(x)}),u&&e.jsx(j,{agent:u,onEdit:()=>o(u)}),t.length===0&&e.jsx("div",{className:"text-center py-12 text-white/40",children:"Aucun agent configure. Contactez l'administrateur NEXUS."})]})]}),m&&e.jsx(N,{agent:m,onClose:()=>o(null),onSave:c})]})}function j({agent:t,onEdit:l}){const r=t.agent_type==="reception",[n,m]=h.useState(!1),o=h.useRef(null),p=async()=>{if(t.voice_id){m(!0);try{const a=await fetch(`/api/admin/agents/${t.id}/test-voice`,{method:"POST",headers:f(),body:JSON.stringify({text:t.greeting_message||`Bonjour, je suis ${t.custom_name}`})});if(a.ok){const s=await a.blob(),i=URL.createObjectURL(s);o.current&&o.current.pause();const b=new Audio(i);o.current=b,b.play(),b.onended=()=>URL.revokeObjectURL(i)}}catch(a){console.error("Voice test error:",a)}finally{m(!1)}}},c={warm:"Chaleureux",professional:"Professionnel",casual:"Decontracte"},x={proactive:"Proactif",reactive:"Reactif",balanced:"Equilibre"},u={concise:"Synthetique",standard:"Standard",detailed:"Detaille"};return e.jsxs("div",{className:"bg-zinc-900/80 border border-white/10 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:`px-5 py-4 flex items-center justify-between border-b ${r?"border-cyan-500/20 bg-cyan-950/20":"border-blue-500/20 bg-blue-950/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-11 h-11 rounded-full flex items-center justify-center text-xl ${r?"bg-cyan-500/20":"bg-blue-500/20"}`,children:r?"ðŸ“ž":"ðŸ¤–"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:t.custom_name}),e.jsxs("p",{className:"text-xs text-white/40",children:[r?"Agent Reception":"Assistant Back-office",t.voice_gender==="female"?" Â· Voix feminine":t.voice_gender==="male"?" Â· Voix masculine":""]})]})]}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-medium ${t.active?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:t.active?"Actif":"Inactif"})]}),e.jsxs("div",{className:"px-5 py-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[r&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:"Specialite",value:t.business_type||"Non defini"}),e.jsx(v,{label:"Canaux",value:"Telephone \\u00B7 WhatsApp \\u00B7 Web"}),e.jsx(v,{label:"Ton",value:c[t.tone||""]||t.tone||"Non defini"})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:"Proactivite",value:x[t.proactivity_level||""]||"Standard"}),e.jsx(v,{label:"Detail",value:u[t.detail_level||""]||"Standard"}),e.jsx(v,{label:"Ton",value:c[t.tone||""]||"Professionnel"})]})]}),r&&t.greeting_message&&e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-white/30 uppercase tracking-wider",children:"Phrase d'accueil"}),e.jsxs("p",{className:"text-sm text-white/70 italic mt-0.5",children:['"',t.greeting_message,'"']})]})]}),e.jsxs("div",{className:"px-5 py-3 border-t border-white/5 flex gap-2",children:[e.jsx("button",{onClick:l,className:"px-3 py-1.5 text-xs bg-white/5 border border-white/10 text-white/70 rounded-lg hover:bg-white/10 hover:text-white transition",children:"Configurer"}),r&&t.voice_id&&e.jsx("button",{onClick:p,disabled:n,className:"px-3 py-1.5 text-xs bg-cyan-900/30 border border-cyan-500/20 text-cyan-400 rounded-lg hover:bg-cyan-900/50 transition disabled:opacity-50",children:n?"Lecture...":"Tester la voix"})]})]})}function v({label:t,value:l}){return e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] text-white/30 uppercase tracking-wider",children:t}),e.jsx("p",{className:"text-sm text-white/70 mt-0.5",children:l})]})}function N({agent:t,onClose:l,onSave:r}){const[n,m]=h.useState({custom_name:t.custom_name,tone:t.tone||"",greeting_message:t.greeting_message||"",signature_phrase:t.signature_phrase||"",voice_id:t.voice_id||"",voice_gender:t.voice_gender||"",voice_style:t.voice_style||"",proactivity_level:t.proactivity_level||"",detail_level:t.detail_level||"",business_type:t.business_type||"",active:t.active}),[o,p]=h.useState(!1),[c,x]=h.useState("identity"),u=t.agent_type==="reception",a=async()=>{p(!0);try{await r(t.id,n)}finally{p(!1)}},s=(i,b)=>m(y=>({...y,[i]:b}));return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-4",onClick:l,children:e.jsxs("div",{className:"bg-zinc-900 border border-white/10 rounded-xl w-full max-w-lg max-h-[85vh] overflow-y-auto",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"px-5 py-4 border-b border-white/10 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Configuration de ",t.custom_name]}),e.jsx("button",{onClick:l,className:"text-white/40 hover:text-white text-xl",children:"Ã—"})]}),e.jsxs("div",{className:"px-5 pt-3 flex gap-1",children:[e.jsx(g,{label:"Identite",active:c==="identity",onClick:()=>x("identity")}),u&&e.jsx(g,{label:"Voix",active:c==="voice",onClick:()=>x("voice")}),e.jsx(g,{label:"Comportement",active:c==="behavior",onClick:()=>x("behavior")})]}),e.jsxs("div",{className:"px-5 py-4 space-y-4",children:[c==="identity"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Nom de l'agent",desc:`Nom par defaut : ${t.default_name}`,children:e.jsx("input",{value:n.custom_name,onChange:i=>s("custom_name",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none"})}),u&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Phrase d'accueil",children:e.jsx("textarea",{value:n.greeting_message,onChange:i=>s("greeting_message",i.target.value),rows:3,className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none resize-none",placeholder:"Ex: Bonjour ! C'est {nom} de {entreprise}"})}),e.jsx(d,{label:"Signature (SMS, messages)",children:e.jsx("input",{value:n.signature_phrase,onChange:i=>s("signature_phrase",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",placeholder:"Ex: A bientot chez Fat's Hair !"})}),e.jsx(d,{label:"Type de metier",children:e.jsx("input",{value:n.business_type,onChange:i=>s("business_type",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",placeholder:"Ex: salon_coiffure_afro"})})]}),e.jsx(d,{label:"Statut",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.active,onChange:i=>s("active",i.target.checked),className:"w-4 h-4 rounded bg-zinc-800 border-white/20 text-amber-500 focus:ring-amber-500"}),e.jsx("span",{className:"text-sm text-white/70",children:"Agent actif"})]})})]}),c==="voice"&&u&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Voix ElevenLabs",children:e.jsxs("select",{value:n.voice_id,onChange:i=>s("voice_id",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"21m00Tcm4TlvDq8ikWAM",children:"Feminine douce (Rachel)"}),e.jsx("option",{value:"EXAVITQu4vr4xnSDxMaL",children:"Feminine energique (Lily)"}),e.jsx("option",{value:"pNInz6obpgDQGcFmaJgB",children:"Masculine posee (Adam)"}),e.jsx("option",{value:"ErXwobaYiN019PkySvjV",children:"Masculine dynamique (Antoni)"})]})}),e.jsx(d,{label:"Genre vocal",children:e.jsxs("select",{value:n.voice_gender,onChange:i=>s("voice_gender",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"female",children:"Feminin"}),e.jsx("option",{value:"male",children:"Masculin"})]})}),e.jsx(d,{label:"Style vocal",children:e.jsxs("select",{value:n.voice_style,onChange:i=>s("voice_style",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"soft",children:"Douce"}),e.jsx("option",{value:"energetic",children:"Energique"}),e.jsx("option",{value:"calm",children:"Calme"}),e.jsx("option",{value:"dynamic",children:"Dynamique"})]})})]}),c==="behavior"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Ton de communication",children:e.jsxs("select",{value:n.tone,onChange:i=>s("tone",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"warm",children:"Chaleureux et convivial"}),e.jsx("option",{value:"professional",children:"Professionnel et formel"}),e.jsx("option",{value:"casual",children:"Decontracte et cool"})]})}),!u&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Proactivite",children:e.jsxs("select",{value:n.proactivity_level,onChange:i=>s("proactivity_level",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"proactive",children:"Proactif (suggere des actions)"}),e.jsx("option",{value:"reactive",children:"Reactif (attend instructions)"}),e.jsx("option",{value:"balanced",children:"Equilibre"})]})}),e.jsx(d,{label:"Niveau de detail",children:e.jsxs("select",{value:n.detail_level,onChange:i=>s("detail_level",i.target.value),className:"w-full bg-zinc-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-amber-500/50 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"concise",children:"Synthetique"}),e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"detailed",children:"Detaille"})]})})]})]})]}),e.jsxs("div",{className:"px-5 py-3 border-t border-white/10 flex justify-end gap-2",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 text-sm text-white/50 hover:text-white transition",children:"Annuler"}),e.jsx("button",{onClick:a,disabled:o,className:"px-4 py-2 text-sm bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-lg hover:opacity-90 transition disabled:opacity-50",children:o?"Enregistrement...":"Enregistrer"})]})]})})}function g({label:t,active:l,onClick:r}){return e.jsx("button",{onClick:r,className:`px-3 py-1.5 text-xs rounded-lg transition ${l?"bg-amber-500/20 text-amber-400 font-medium":"text-white/40 hover:text-white/70"}`,children:t})}function d({label:t,desc:l,children:r}){return e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-white/70",children:t}),l&&e.jsx("p",{className:"text-[10px] text-white/30 mb-1",children:l}),e.jsx("div",{className:"mt-1",children:r})]})}export{$ as default};
